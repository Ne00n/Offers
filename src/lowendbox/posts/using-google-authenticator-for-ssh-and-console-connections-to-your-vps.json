{"id": "23141", "post": "<div class=\"post-23141 post type-post status-publish format-standard hentry category-tutorials tag-google-autheticator tag-security tag-tutorial tag-two-factor-security\" id=\"post-23141\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/using-google-authenticator-for-ssh-and-console-connections-to-your-vps/\" rel=\"bookmark\">Using Google Authenticator for SSH and Console Connections to Your VPS</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/google-autheticator/\" rel=\"tag\">google autheticator</a>, <a href=\"https://lowendbox.com/tag/security/\" rel=\"tag\">Security</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a>, <a href=\"https://lowendbox.com/tag/two-factor-security/\" rel=\"tag\">two factor security</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> August 22, 2020 @ 4:52 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a target=\"_blank\" rel=\"noopener noreferrer\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MTYiIGhlaWdodD0iMjM0IiB2aWV3Qm94PSIwIDAgNDE2IDIzNCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"screenshot\" title=\"Using Google Authenticator for SSH and Console Connections to Your VPS\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/google-authenticator-for-ssh-and-console-connections.jpg.webp\" alt=\"Using Google Authenticator for SSH and Console Connections to Your VPS\" width=\"416\" height=\"234\"></a>In this tutorial, we\u2019re going to show you how to setup your VPS to use two-factor authentication for both normal SSH connections and console logins with Google Authenticator.</p><h1>What is Two-Factor Authentication?</h1><p>\u201cOne factor\u201d authentication is either \u201csomething you know\u201d or \u201csomething you have\u201d. For example, logging in with a password is \u201csomething you know\u201d and so that is single-factor authentication. Two factor authentication requires <strong>both</strong> something you know and something you have. A common means to achieve this is by using SSH keys. You must have both the SSH private key file and know the passphrase to unlock that SSH private key. If someone looked over your shoulder and saw you type your SSH key passphrase, or if someone stole your SSH private key file, neither by themself would be sufficient. They would need to know both your passphrase and have your key file to be successful.</p><p><span id=\"more-23141\"></span></p><h1>What Problems Are We Trying to Solve?</h1><p>The problem with SSH private keys is that you must carry the file around with you. If you\u2019re always logging in from home or from one laptop, that\u2019s fine, but what if you want to login from a friend\u2019s house, from work, or from the library? Either you have to carry your private key around on a USB or put it on cloud storage, neither of which is optimal. Is there a way we can require \u201csomething you have\u201d without needing to have access a file? Yes, with Google Authenticator.</p><p>Another problem is console access. Your VPS provider provides console access as a way for you to access your VPS if you can\u2019t get in via ssh (for example, if you munge the firewall rules).&nbsp; Here you <strong>cannot</strong> use an SSH key file.&nbsp; This means that access to all of your VPSes with that provider are dependent on whatever password you setup for the provider\u2019s control panel. Worse, that password is sometimes emailed to you in clear text! This also means that if someone can get ahold of your email, then they can do a password reset, recover your control panel password, and compromise all of your VPSes. However, we can plug this hole, too, with Google Authenticator.</p><h1>What is Google Authenticator?</h1><p>Instead of having a key file, in this system your \u201cwhat you know\u201d is the Google Authenticator app. Every 30 seconds, the Authenticator displays a new 6-digit number. Through some crypto mathematical wizardry, your VPS knows what this number is. When you login, you\u2019re prompted to enter this number after entering your Unix password.</p><p>To be clear, no one else can easily guess this number, and the number is only good for 30 seconds. So even if someone did see your number, they only have 30 seconds to try to reuse it. You can even defeat that by rate-limiting logins so that the number can only be used once.</p><h1>Setting Up Google Authenticator on Your VPS</h1><p>I\u2019ll be using a brand spanking new Debian 10 VM I\u2019ve named fortress.lowend.party. After imaging it, I\u2019ll setup the PAM module for Google Authenticator and reconfigure sshd. PAM stands for Pluggable Authentication Module. It allows you to setup requirements for any kind of authentication \u2013 login, sudo, etc. In this case, we\u2019re going to setup an sshd authentication that requires both the Unix password and Google Authenticator.</p><pre>apt-get update\napt-get -y install libpam-google-authenticator</pre><p>Google Authenticator requires time sync, so let\u2019s make sure our VPS always has the proper time. We\u2019ll use ntpd (the Network Time Protocol daemon) for this purpose.</p><pre>apt-get -y install ntp\nsystemctl start ntp\nsystemctl enable ntp</pre><p>NTP is timezone-agnostic, but if you haven\u2019t done so, you might want to set your timezone properly here.</p><pre>dpkg-reconfigure tzdata</pre><p>Or if you know the name of the timezone you want to use:</p><pre>timedatectl set-timezone America/Los_Angeles</pre><h1>Running Google Authenticator</h1><p>Now I\u2019ll switch to a user I\u2019ll use for login (raindog308) and run the Google Authenticator setup.</p><pre>raindog308@fortress:~$ google-authenticator\nDo you want authentication tokens to be time-based (y/n) y</pre><p>Say yes to this question.&nbsp; Now a pretty cool QR scan code will print out, in your terminal, for you to scan with your phone:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iNzY3IiB2aWV3Qm94PSIwIDAgODAwIDc2NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23143\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-1.png.webp\" alt=\"\" width=\"800\" height=\"767\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-1.png.webp 800w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-1-300x288.png.webp 300w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-1-768x736.png.webp 768w\" data-sizes=\"(max-width: 800px) 100vw, 800px\"></p><p>Let\u2019s setup the app while the QR code is still on your screen.</p><h1>Setting Up the Google Authenticator App</h1><p>In my case I\u2019m using an iPhone. I\u2019ve installed the free Google Authenticator app from the App Store and started it.</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23144\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-2.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-2.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-2-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>Tap Begin Setup (at bottom).</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23145\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-3.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-3.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-3-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>Tap Scan barcode.</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23146\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-4.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-4.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-4-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>Give permission to access your camera. Then hold your phone up to your screen so the QR code appears in the green box. Moments later, the app will register your authenticator.</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23147\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-5.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-5.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-5-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><h1>Finishing VPS Setup</h1><p>Now go back to your terminal session. Copy and save the secret key, verification code, and emergency codes in some secure place. An entry in whatever password safe you use is an excellent choice.</p><p>Now finish answering the questions:</p><pre>Do you want me to update your \"/home/raindog308/.google_authenticator\" file? (y/n) y</pre><p>Say yes!</p><pre>Do you want to disallow multiple uses of the same authentication\ntoken? This restricts you to one login about every 30s, but it increases\nyour chances to notice or even prevent man-in-the-middle attacks (y/n)</pre><p>Your choice, but saying yes is more secure.</p><pre>By default, a new token is generated every 30 seconds by the mobile app.\nIn order to compensate for possible time-skew between the client and the server,\nwe allow an extra token before and after the current time. This allows for a\ntime skew of up to 30 seconds between authentication server and client. If you\nexperience problems with poor time synchronization, you can increase the window\nfrom its default size of 3 permitted codes (one previous code, the current\ncode, the next code) to 17 permitted codes (the 8 previous codes, the current\ncode, and the 8 next codes). This will permit for a time skew of up to 4 minutes\nbetween client and server.\nDo you want to do so? (y/n)</pre><p>You shouldn\u2019t really need this. Say no.</p><pre>If the computer that you are logging into isn't hardened against brute-force\nlogin attempts, you can enable rate-limiting for the authentication module.\nBy default, this limits attackers to no more than 3 login attempts every 30s.\nDo you want to enable rate-limiting? (y/n)</pre><p>Your choice but yes is the more secure choice.</p><h1>Setting Up PAM and sshd_config</h1><p>Now open a new shell and su or sudo to root. You\u2019re going to keep this second session open so that if anything is fumbled while setting up Google Authenticator, you have a fallback session and can quickly fix things.</p><p>Edit /etc/pam.d/sshd and add the following two lines:</p><pre>auth required pam_unix.so no_warn try_first_pass\nauth required pam_google_authenticator.so</pre><p>These lines mean mean \u201cUnix password required, Google Authenticator required\u201d.</p><p>Now edit /etc/ssh/sshd_config and change as follows:</p><pre>UsePAM yes\nChallengeResponseAuthentication yes</pre><p>This will require Google Authenticator for all users. Note that Google Authenticator is <strong>not</strong> required for SSH keys. So the requirements to login are either (1) you have your private ssh key file and know its passphrase, or (2) you enter the Unix password <em>and</em> enter the proper Google Authenticator 6-digit code. Note that root logins are special and are handled by the PermitRootLogin directive in sshd_config. Normally, PermitRootLogin should either be set to \u201cno\u201d or \u201cprohibit-password\u201d to require SSH keys.&nbsp; We\u2019ll fix console logins later in this tutorial.</p><p>Restart sshd:</p><pre>systemctl restart ssh</pre><p>Now let\u2019s try logging in. Open a new terminal so you can use the root session as a fallback.</p><pre>$ ssh raindog308@fortress.lowend.party\nPassword:\nVerification code:\nLinux fortress.lowend.party 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26) x86_64\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nraindog308@fortress:~$</pre><p>At the \u201cVerification code\u201d prompt, I entered the six-digit code on my Google Authenticator app. We are officially party rockin\u2019!</p><h1>Securing Console Login</h1><p>To require Google Authenticator for console logins, you probably want to configure Google Authenticator for the root account so you can login as root on the console. Just repeat the google-authenticator steps above to generate the QR code and register it with your app. You\u2019ll have two entries in your app:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23148\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-6.jpeg.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-6.jpeg.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-6-169x300.jpeg.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>Now edit /etc/pam.d/login and add this line:</p><pre>auth required pam_google_authenticator.so</pre><p>This is the same as one of the entries we put in /etc/pam.d/sshd.</p><p>Now if you go to your provider\u2019s panel and try to login on the console (as root) you\u2019ll find you\u2019re required to use Google Authenticator.</p><pre>Debian GNU/Linux 10 fortress.lowend.party ttyS0\n\nfortress login: root\nPassword:\nVerification code:\nLast login: Wed May 13 16:20:09 PDT 2020 on ttyS0\nLinux fortress.lowend.party 4.19.0-8-amd64 #1 SMP Debian 4.19.98-1 (2020-01-26)4\n\nThe programs included with the Debian GNU/Linux system are free software;\nthe exact distribution terms for each program are described in the\nindividual files in /usr/share/doc/*/copyright.\n\nDebian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent\npermitted by applicable law.\nroot@fortress:~#</pre><h1>Backing Up Your Google Authenticator Config</h1><p>In the user\u2019s home directory you\u2019ll find a file called .google-authenticator. If you were to nuke your VPS, setup Google Authenticator again, and then place this file back in the user\u2019s home directory (with proper ownership and mode 0600), Google Authenticator would work for that user.</p><p>If your phone was lost or for some other reason you needed to reinstall the Google Authenticator app, you would select \u201cManual entry\u201d in the app and then enter both the account and the key. That was the part that said:</p><pre>Your new secret key is: BY7QKIUJR2WLPRKT53UR5VPKZU</pre><p>You did save that key somewhere safe\u2026right?</p><p>The key also appears as the first line in the .google-authenticator file. Here, for example, is my .google-authenticator file on fortress.lowend.party:</p><pre>BY7QKIUJR2WLPRKT53UR5VPKZU\n\" RATE_LIMIT 3 30 1589413925\n\" TOTP_AUTH\n36720568\n35095323\n92648133\n21906908\n71813960</pre><p>To simulate loss of my phone, I deleted the raindog308@fortress.lowend.party from my Google Authenticator app:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23149\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-7.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-7.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-7-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>Then I hit the \u201c+\u201d button in the upper right and selected Manual entry:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23150\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-8.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-8.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-8-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>I typed in my name for the account (raindog308@fortress.lowend.party) and then laboriously entered the key (BY7QKIUJR2WLPRKT53UR5VPKZU):</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23151\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-9.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-9.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-9-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>The entry was thus recreated:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0NTAiIGhlaWdodD0iODAwIiB2aWV3Qm94PSIwIDAgNDUwIDgwMCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-23152\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-10.png.webp\" alt=\"\" width=\"450\" height=\"800\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-10.png.webp 450w, https://lowendbox.com/wp-content/uploads/2020/05/Google-Authenticator-10-169x300.png.webp 169w\" data-sizes=\"(max-width: 450px) 100vw, 450px\"></p><p>I was then able to login again as raindog308 with Google Authenticator.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fusing-google-authenticator-for-ssh-and-console-connections-to-your-vps%2F&amp;t=Using%20Google%20Authenticator%20for%20SSH%20and%20Console%20Connections%20to%20Your%20VPS\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Using%20Google%20Authenticator%20for%20SSH%20and%20Console%20Connections%20to%20Your%20VPS&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fusing-google-authenticator-for-ssh-and-console-connections-to-your-vps%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fusing-google-authenticator-for-ssh-and-console-connections-to-your-vps%2F&amp;title=Using%20Google%20Authenticator%20for%20SSH%20and%20Console%20Connections%20to%20Your%20VPS&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">2</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendprotection-homemade-raspberry-pi-security-cloud-camera-setup/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/07/rpi_security1-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Keeping A (log)Watchful Eye on Your VPS With logwatch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/logwatch-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Keeping A (log)Watchful Eye on Your VPS With logwatch</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}