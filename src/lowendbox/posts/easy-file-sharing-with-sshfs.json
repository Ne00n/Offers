{"id": "23269", "post": "<div class=\"post-23269 post type-post status-publish format-standard hentry category-tutorials tag-file-sharing tag-sshfs tag-tutorial\" id=\"post-23269\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/easy-file-sharing-with-sshfs/\" rel=\"bookmark\">Easy File Sharing With sshfs</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/file-sharing/\" rel=\"tag\">file sharing</a>, <a href=\"https://lowendbox.com/tag/sshfs/\" rel=\"tag\">sshfs</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> July 19, 2020 @ 8:58 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a target=\"_blank\" rel=\"noopener noreferrer\"><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2020/05/easy-file-sharing-with-sshfs.jpg.webp\" loading=\"lazy\" class=\"screenshot litespeed-loaded\" title=\"Easy File Sharing with sshfs on your VPS Server\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/easy-file-sharing-with-sshfs.jpg.webp\" alt=\"Easy File Sharing with sshfs on your VPS Server\" width=\"416\" height=\"240\" data-was-processed=\"true\"></a></p><p>scp, sftp, and other protocols are useful for one-time file transfers, but what if you want to have a permanent connection that allows you to treat a remote filesystem as local? You could look at nfs, but nfs was never designed for WAN usage and requires extra protocols (IPSEC, Kerneros, etc.) to encrypt in-flight data.</p><p>There are cloud solutions such as Dropbox, but the simplest solution is probably sshfs. sshfs is a technology that allows you to mount a remote filesystem and treat it as local storage. You can cp, rm, mv, etc. just as you would with a local filesystem.</p><p>In this tutorial we\u2019ll setup an sshfs mount.</p><p><span id=\"more-23269\"></span></p><h1>Installation and Setup</h1><p>I\u2019ll be using two servers, named server1.lowend.party (in Fremont, CA) and server2.lowend.party (in Dallas, TX). Both are running Debian 10.</p><p>After imaging, installing sshfs is as simple as</p><pre>sudo apt-get -y install sshfs</pre><p>On both servers, I\u2019ll create a user called raindog308, and be careful to make sure the UIDs were the same on both sides.</p><pre>root@server1:~# useradd -u 1001 -m -s /bin/bash raindog308\nroot@server1:~# passwd raindog308\nNew password: \nRetype new password: \npasswd: password updated successfully\nroot@server1:~#</pre><p>I also added raindog308 to the sudo group:</p><pre>root@server1:~# usermod -G sudo raindog308</pre><p>I\u2019m going to use a passwordless ssh key for authentication, which I create via ssh-keygen. On server2, I\u2019ll switch to the raindog308 user and create the key:</p><pre>root@server2:~# su - raindog308\nraindog308@server2:~$ ssh-keygen -f /home/raindog308/.ssh/sshfs-key -t ed25519\nGenerating public/private ed25519 key pair.\nEnter passphrase (empty for no passphrase): \nEnter same passphrase again: \nYour identification has been saved in /home/raindog308/.ssh/sshfs-key.\nYour public key has been saved in /home/raindog308/.ssh/sshfs-key.pub.\nThe key fingerprint is:\nSHA256:D3EuLxSdHJy+lLWEgvII94eL7tYu91dRkCqR91YxZss raindog308@server2.lowend.party\nThe key's randomart image is:\n+--[ED25519 256]--+\n| . o.o.o=. |\n| . o . +o=o++oo |\n| o = .o==* +E |\n| . + o== = |\n| . oSo.o . |\n| . .. =. . |\n| . . . o. |\n| + o .. |\n| o.+.... |\n+----[SHA256]-----+</pre><p>I\u2019ll copy the ssh public key:</p><pre>raindog308@server2:~$ cat .ssh/sshfs-key.pub \nssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOLc4JrHS1hqLhUGSfL+DQgyJ+cOq3WyN/ONCdEP7rmG raindog308@server2.lowend.party</pre><p>Then on server1:</p><pre>raindog308@server1:~$ cd\nraindog308@server1:~$ mkdir .ssh\nraindog308@server1:~$ echo \"ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIOLc4JrHS1hqLhUGSf\nL+DQgyJ+cOq3WyN/ONCdEP7rmG raindog308@server2.lowend.party\" &gt; .ssh/authorized_keys\nraindog308@server1:~$ chmod 600 .ssh/authorized_keys \nraindog308@server1:~$ chmod 700 .ssh</pre><p>On server1, raindog308 created a directory in his home directory called \u201cshared\u201d:</p><pre>root@server1:~# su - raindog308\nraindog308@server1:~$ cd\nraindog308@server1:~$ mkdir shared</pre><p>Next, I populated it with a test file:</p><pre>raindog308@server1:~$ cat &gt; ~/shared/test.txt\nThis is a test file. It is very exciting and is very important.\nraindog308@server1:~$</pre><p>On server2, I also created the directory \u2018shared\u2019 as raindog308:</p><pre>raindog308@server2:~$ logout\nroot@server2:~# su - raindog308\nraindog308@server2:~$ cd\nraindog308@server2:~$ mkdir shared</pre><h1>Mounting sshfs</h1><p>Now I\u2019m ready to mount server1\u2019s /home/raindog308/shared directory on server2.</p><pre>raindog308@server2:~$ sshfs -o default_permissions,IdentityFile=/home/raindog308/.\nssh/sshfs-key raindog308@server1.lowend.party:/home/raindog308/shared /home/raindo\ng308/shared\nraindog308@server2:~$ ls -ld shared\ndrwxr-xr-x 1 raindog308 raindog308 4096 May 21 09:00 shared\nraindog308@server2:~$ ls -l shared\ntotal 4\n-rw-r--r-- 1 raindog308 raindog308 65 May 21 09:00 test.txt</pre><p>Looking at df and mount:</p><pre>raindog308@server2:~$ df -h | grep shared\nraindog308@server1.lowend.party:/home/raindog308/shared 25G 1.1G 22G 5% /home/raindog308/shared\nraindog308@server2:~$ mount | grep shared\nraindog308@server1.lowend.party:/home/raindog308/shared on /home/raindog308/shared type fuse.sshfs (rw,nosuid,nodev,relatime,user_id=1001,group_id=1001,default_permissions)</pre><p>Looking in shared:</p><pre>raindog308@server2:~$ ls -l shared\ntotal 4\n-rw-r--r-- 1 raindog308 raindog308 65 May 21 09:00 test.txt\nraindog308@server2:~$ cat shared/test.txt \nThis is a test file. It is very exciting and is very important.\nraindog308@server2:~$</pre><p>Let\u2019s create a file on server2:</p><pre>raindog308@server2:~$ cat &gt; shared/test2.txt\nLife, liberty, and the pursuit of the $7 VPS.\nraindog308@server2:~$ ls -l shared\ntotal 8\n-rw-r--r-- 1 raindog308 raindog308 46 May 21 09:13 test2.txt\n-rw-r--r-- 1 raindog308 raindog308 65 May 21 09:00 test.txt\nraindog308@server2:~$</pre><p>And back on server1:</p><pre>raindog308@server1:~$ ls -l ~/shared/\ntotal 8\n-rw-r--r-- 1 raindog308 raindog308 46 May 21 09:13 test2.txt\n-rw-r--r-- 1 raindog308 raindog308 65 May 21 09:00 test.txt\nraindog308@server1:~$ cat ~/shared/test2.txt \nLife, liberty, and the pursuit of the $7 VPS.</pre><h1>Permanently Mounting sshfs</h1><p>If you want this mount to be automatically mounted at boot-time, you can add a line like this in /etc/fstab:</p><pre>raindog308@server1.lowend.party:/home/raindog308/shared /home/raindog308/shared fuse.sshfs delay_connect,defaults,IdentityFile=/home/raindog308/.ssh/sshfs 0 0</pre><h1>Unmounting</h1><p>Unmounting is as simple as</p><pre>raindog308@server2:~$ sudo umount /home/raindog308/shared\n[sudo] password for raindog308: \nraindog308@server2:~$ mount | grep shared</pre><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Feasy-file-sharing-with-sshfs%2F&amp;t=Easy%20File%20Sharing%20With%20sshfs\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Easy%20File%20Sharing%20With%20sshfs&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Feasy-file-sharing-with-sshfs%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Feasy-file-sharing-with-sshfs%2F&amp;title=Easy%20File%20Sharing%20With%20sshfs&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">5</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Keeping A (log)Watchful Eye on Your VPS With logwatch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/logwatch-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Keeping A (log)Watchful Eye on Your VPS With logwatch</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo litespeed-loaded\" height=\"70\" width=\"70\" loading=\"lazy\" srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" data-was-processed=\"true\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}