{"id": "28301", "post": "<div class=\"post-28301 post type-post status-publish format-standard hentry category-tutorials tag-inventory tag-nmap tag-security\" id=\"post-28301\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/easy-operating-system-detection-with-nmap/\" rel=\"bookmark\">Easy Operating System Detection with nmap</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" width=\"16\" height=\"16\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/inventory/\" rel=\"tag\">inventory</a>, <a href=\"https://lowendbox.com/tag/nmap/\" rel=\"tag\">nmap</a>, <a href=\"https://lowendbox.com/tag/security/\" rel=\"tag\">Security</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" width=\"16\" height=\"16\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> September 18, 2021 @ 12:00 am, by raindog308</div><div class=\"storycontent tablelook\"><p><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2021/09/nmap.png\" loading=\"lazy\" class=\"alignright size-full wp-image-28303 litespeed-loaded\" data-src=\"https://lowendbox.com/wp-content/uploads/2021/09/nmap.png\" alt=\"nmap\" width=\"300\" height=\"300\" align=\"right\" hspace=\"20\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2021/09/nmap.png 300w, https://lowendbox.com/wp-content/uploads/2021/09/nmap-150x150.png 150w\" data-sizes=\"(max-width: 300px) 100vw, 300px\" sizes=\"(max-width: 300px) 100vw, 300px\" srcset=\"https://lowendbox.com/wp-content/uploads/2021/09/nmap.png 300w, https://lowendbox.com/wp-content/uploads/2021/09/nmap-150x150.png 150w\" data-was-processed=\"true\">Recently I was doing some discovery at work of some systems we inherited.&nbsp; I didn\u2019t yet have access but wanted to determine what type of OS was involved so I could coordinate with the proper teams.</p><p>You can often guess just by determining what ports are open, but the most efficient tool is the venerable nmap utility.&nbsp; Using the -O (OS detection) and -sV (check ports to determine service/version info) flags, you get a complete report.</p><p>Under the covers, nmap is running through a set of heuristics to determine what OS is most likely, based on what ports are open and unique \u201cfingerprinting\u201d of the device\u2019s IP stack.&nbsp; nmap maintains a database of over 2,000 IP fingerprints.&nbsp; Different operating systems will set different values for things like initial TTL, max segment size, window scaling value, etc. and by analyzing packets, nmap can make an educated guess of what kind of OS is running.</p><p>It\u2019s not 100% and nmap lacks the ability to say \u201cthis is definitely Windows Server 2012 with Service Pack 2 applied\u201d or \u201cthis is definitely Debian 9 and not Debian 10\u201d because operating systems in the same family often us the same IP stack.&nbsp; But it is often an excellent start towards identification.</p><p>For example, here is output of a Windows Server which is also running MySQL (all examples in this article have been slightly reformatted in terms of line breaks to fit the site\u2019s theme):</p><pre># nmap -O -sV x.x.x.x\nStarting Nmap 7.92 ( <a href=\"https://nmap.org/\">https://nmap.org</a> ) at 2021-09-17 11:02 PDT\nNmap scan report for x.x.x.x\nHost is up (0.22s latency).\nNot shown: 994 closed tcp ports (reset)\n\n\nPORT &nbsp; &nbsp; STATE SERVICE &nbsp; &nbsp; &nbsp; VERSION\n135/tcp&nbsp; open&nbsp; msrpc &nbsp; &nbsp; &nbsp; &nbsp; Microsoft Windows RPC\n139/tcp&nbsp; open&nbsp; netbios-ssn &nbsp; Microsoft Windows netbios-ssn\n445/tcp&nbsp; open&nbsp; microsoft-ds?\n2701/tcp open&nbsp; cmrcservice &nbsp; Microsoft Configuration Manager Remote Control service (CmRcService.exe)\n3306/tcp open&nbsp; mysql &nbsp; &nbsp; &nbsp; &nbsp; MySQL 5.1.60-community-log\n3389/tcp open&nbsp; ms-wbt-server Microsoft Terminal Services\n\nAggressive OS guesses: Microsoft Windows Server 2016 (93%), \nMicrosoft Windows Server 2008 R2 SP1 (92%), Microsoft Windows Server 2012 R2 (91%), \nMicrosoft Windows 10 1607 (90%), Microsoft Windows Server 2008 R2 (90%), \nMicrosoft Windows Server 2012 (89%), Microsoft Windows Server 2012 or \nWindows Server 2012 R2 (89%), Microsoft Windows Server 2008 R2 or Windows 8 (87%), \nMicrosoft Windows Server 2008 R2 SP1 or Windows 8 (87%), Microsoft Windows 7 SP1 (86%)\nNo exact OS matches for host (test conditions non-ideal).\nNetwork Distance: 18 hops\nService Info: OS: Windows; CPE: cpe:/o:microsoft:windows\n\nOS and Service detection performed. Please report any incorrect results at <a href=\"https://nmap.org/submit/\">https://nmap.org/submit/</a> .\nNmap done: 1 IP address (1 host up) scanned in 33.77 seconds</pre><p>Here\u2019s what a Debian 9 server I scanned looks like:</p><pre class=\"p1\"><span class=\"s1\"># time nmap -O -sV x.x.x.x\n</span><span class=\"s1\">Starting Nmap 7.92 ( https://nmap.org ) at 2021-09-17 14:52 PDT\n</span><span class=\"s1\">Nmap scan report for x.x.x.x\n</span><span class=\"s1\">Host is up (0.0018s latency).\n</span><span class=\"s1\">Not shown: 992 closed tcp ports (reset)\n</span><span class=\"s1\">PORT <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>STATE SERVICE <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>VERSION\n</span><span class=\"s1\">22/tcp <span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>ssh <span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>OpenSSH 7.4p1 Debian 10+deb9u7 (protocol 2.0)\n</span><span class=\"s1\">25/tcp <span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>smtp<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Postfix smtpd\n</span><span class=\"s1\">80/tcp <span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>http<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>nginx 1.10.3\n</span><span class=\"s1\">111/tcp<span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>rpcbind <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>2-4 (RPC #100000)\n</span><span class=\"s1\">139/tcp<span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>netbios-ssn Samba smbd 3.X - 4.X (workgroup: EXAMPLE)\n</span><span class=\"s1\">445/tcp<span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>netbios-ssn Samba smbd 3.X - 4.X (workgroup: EXAMPLe)\n</span><span class=\"s1\">587/tcp<span class=\"Apple-converted-space\">&nbsp; </span>open<span class=\"Apple-converted-space\">&nbsp; </span>smtp<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Postfix smtpd\n</span><span class=\"s1\">3306/tcp open<span class=\"Apple-converted-space\">&nbsp; </span>mysql <span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; </span>MySQL 5.5.5-10.1.48-MariaDB-0+deb9u2\n</span><span class=\"s1\">MAC Address: MM:MM:MM:MM:MM:MM (Asustek Computer)\n</span><span class=\"s1\">Device type: general purpose\n</span><span class=\"s1\">Running: Linux 3.X|4.X\n</span><span class=\"s1\">OS CPE: cpe:/o:linux:linux_kernel:3 cpe:/o:linux:linux_kernel:4\n</span><span class=\"s1\">OS details: Linux 3.2 - 4.9\n</span><span class=\"s1\">Network Distance: 1 hop\n</span><span class=\"s1\">Service Info: Hosts:<span class=\"Apple-converted-space\">&nbsp; </span>example.example.com; OS: Linux; CPE: cpe:/o:linux:linux_kernel\n</span>\n\n<span class=\"s1\">OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .\n</span><span class=\"s1\">Nmap done: 1 IP address (1 host up) scanned in 13.52 seconds</span></pre><p>And it\u2019s really just that simple.&nbsp; Next time you have a system on your network but are not sure what it is, try nmap\u2019s OS detection tool to get a pretty good guess.</p><p>&nbsp;</p><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/t-mobile-leaks-almost-50-million-peoples-ssns-and-drivers-licenses/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"T-Mobile Logo\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/08/t-mobile-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">T-Mobile Leaks Almost 50 Million People's SSNs and Driver's Licenses</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/report-reveals-cpanel-whm-suffers-multiple-vulnerabilities/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"cPanel\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/08/cpanel_300-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Report Reveals cPanel/WHM Suffers \"Multiple Vulnerabilities\"</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/get-notified-via-email-whenever-someone-logs-in-to-your-vps/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Email Alert\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/08/email-alert-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Get Notified via Email Whenever Someone Logs In To Your VPS</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/comment-free-for-all-hacking-in-the-movies/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Comment Free For All\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/03/comment-free-for-all-150x150.png.webp) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Comment Free For All: Hacking in the Movies</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}