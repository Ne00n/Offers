{"id": "1256", "post": "<div class=\"post-1256 post type-post status-publish format-standard hentry category-tutorials tag-git tag-nginx tag-trac\" id=\"post-1256\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/running-trac-git-hosting-on-a-low-end-vps/\" rel=\"bookmark\">Running Trac + Git Hosting on a Low End VPS</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/git/\" rel=\"tag\">git</a>, <a href=\"https://lowendbox.com/tag/nginx/\" rel=\"tag\">nginx</a>, <a href=\"https://lowendbox.com/tag/trac/\" rel=\"tag\">trac</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> August 31, 2010 @ 2:59 am, by LowEndAdmin</div><div class=\"storycontent tablelook\"><p><img data-lazyloaded=\"1\" src=\"/media/pix/trac-logo.png\" style=\"margin: 0 1ex 1ex 0; float: left;\" data-src=\"/media/pix/trac-logo.png\" alt=\"Trac\" class=\"litespeed-loaded\" data-was-processed=\"true\"> Any user of Version Control System? When I started as a programmer back in the 90\u2019s it was RCS. Then moved to CVS when I joined my first start up. About 5 years ago I moved everything \u2014 work projects and personal projects \u2014 to Subversion. And these days I use Git for my personal projects. While I <em>could</em> pay someone (<a href=\"http://github.com/\">GitHub</a> for example, or <a href=\"http://repositoryhosting.com/\">RepositoryHosting</a> which is quite cheap for unlimited repositories), for a peace of mind I would rather host the shared central repositories myself and organise my own backups.</p><p>At the same time I would like to have a bug/enhancement tracking system to track and to prioritize my work. A wiki for documentation would be a bonus (if I ever have time to write docos). <a href=\"http://trac.edgewall.org/\">Trac</a> fits the bill. I know there is also <a href=\"http://www.redmine.org/issues/6249\">RedMine</a> but I am a Python developer it\u2019s just easier for me to write plugins for Trac.</p><p>This will (hopefully) be a step-by-step guide to install both Git and Trac 0.12 on a Ubuntu 10.04 system. I used my <a href=\"/blog/rackvm-6-gbpyear-128mb-openvz-vps-in-uk-exclusive-offer/\">6 pound/year RackVM VPS in UK</a> to write this HOWTO. 256MB burstable memory is more than enough.</p><p>Do note that <b>this is not a tutorial on how to use git</b> or any other distributed version control system. See <a href=\"http://git-scm.com/\">Git\u2019s website</a> if you wish to learn more about it.</p><p><span id=\"more-1256\"></span></p><h3>1. Setting up a Low End Box</h3><p>To get the basics running,</p><ol><li>Get an empty VPS, but feel free to use one that is already deployed for something else \u2014 in this case feel free to skip this method and just make sure Nginx is installed.</li><li>Refer to <a href=\"/blog/wordpress-cheap-vps-lowendscript/\">the lowendscript article</a> to set up a low end VPS with Exim4 and Nginx running.</li></ol><pre class=\"code\"># <b>wget http://github.com/lowendbox/lowendscript/raw/master/setup-debian.sh</b>\n...\n# <b>bash setup-debian.sh system</b>\n...\n# <b>bash setup-debian.sh exim4</b>\n...\n# <b>bash setup-debian.sh nginx</b>\n...\n</pre><h3>2. Install Git and Set up Master Repository</h3><p>Make sure git is installed. We are also creating a git user under <code>/home/git</code> as the home of all repositories.</p><pre class=\"code\"># <b>apt-get install -y git-core</b>\n...\n# <b>useradd -m -K UMASK=027 git</b>\n</pre><p>Now you have a \u201cgit\u201d user. You could set it up with <code>git-shell</code> as restricted login shell (which also needs to be added to <code>/etc/shells</code>), however I found it\u2019s too restrictive, especially when I also want to be able to copy the repositories around with scp. You will also need to decide how to authenticate it \u2014 with password or with pubkeys so you can log in to push/pull the git repositories in there.</p><p>For example I want to create copy my lowendscript repository there. I will do this on my home computer (assuming running Linux).</p><pre class=\"code\">$ <b>cd ~/proj/lowendscript</b>\n$ <b>git clone --bare . /tmp/lowendscript.git</b>\n$ <b>scp -r /tmp/lowendscript.git git@my-gitbox:</b>\n$ <b>git remote add origin git@my-gitbox:lowendscript.git</b>\n</pre><p>Replace \u201cmy-gitbox\u201d with the hostname of your VPS. <code>scp</code> would only work <em>after</em> you have set up authentication for user \u201cgit\u201d (password or pubkey).</p><p>You should now be able to push/pull from the central shared repository.</p><h3>3. Install Trac</h3><p>Ubuntu 10.04 LTS only comes with Trac 0.11 but I <em>really</em> wanted to use Trac 0.12 because of better multi-repositories support. So instead of <code>apt-get install trac</code>, we are going the long way and downloading and installing it manually. The <a href=\"http://trac.edgewall.org/wiki/TracInstall\">Trac installation guide</a> is a good reference, as well as <a href=\"http://trac-hacks.org/wiki/GitPlugin\">Git plugin for Trac</a>.</p><p>Let\u2019s get some Python dependencies installed first, and then use <code>easy_install</code> to install Trac and Git plugin. Note that Genshi 0.6 is required for Trac so we won\u2019t be using the 0.5 from Ubuntu repo.</p><pre class=\"code\"># <b>apt-get install python python-setuptools python-pygments python-tz subversion</b>\n...\n# <b>easy_install Trac</b>\n...\n# <b>easy_install http://trac-hacks.org/svn/gitplugin/0.12</b>\n...\n</pre><p>I will now create a trac user to run the standalone instance, and initialize our first Trac project. Note that I am adding user trac into git group so it can have read access to the git repositories.</p><pre class=\"code\"># <b>useradd -m -K UMASK=077 -G git trac</b>\n# <b>sudo -u trac trac-admin ~trac/project initenv</b>\n...\n</pre><p>Just put in your new project\u2019s name (that can be changed later), and use the default for the rest. Done! You have a Trac project created, and it\u2019s time to get the Trac standalone server up and running.</p><pre class=\"code\"># <b>sudo -u trac tracd -s -p 8000 --pidfile ~trac/project/tracd.pid -d ~trac/project</b>\n</pre><p>You should be able to connect to port 8000 on your VPS via your browser to see it up and running. <em>However</em>, a plain vanilla Trac installation is not very useful. We need to get authentication working first so you can administer your Trac install from its web interface. You can find more info on setting up authentication for Trac standalone server <a href=\"http://trac.edgewall.org/wiki/TracStandalone#UsingAuthentication\">here</a>. Need to get apache2-utils installed first so we can use htpasswd.</p><p>I\u2019ll also create a \u201clowendadmin\u201d user with password \u201c12345\u201d.</p><pre class=\"code\"># <b>apt-get install apache2-utils</b>\n...\n# <b>sudo -u trac htpasswd -bc ~trac/project/htpasswd lowendadmin 12345</b>\nAdding password for user lowendadmin\n</pre><p>We will also need to grant <a href=\"http://trac.edgewall.org/wiki/WebAdmin\">WebAdmin</a> permission to the user \u201clowendadmin\u201d. Now restart Trac to use the <b>htpasswd</b> file we have just created.</p><pre class=\"code\"># <b>[ -e ~trac/project/tracd.pid ] &amp;&amp; kill `cat ~trac/project/tracd.pid`</b>\n# <b>sudo -u trac trac-admin ~trac/project permission add lowendadmin TRAC_ADMIN</b>\n# <b>sudo -u trac tracd -s -p 8000 --pidfile ~trac/project/tracd.pid -d --basic-auth=\"*,/home/trac/project/htpasswd,Project\" ~trac/project</b>\n</pre><p>When you log back into Trac (port 8000 on your VPS), you should be able to see a \u201cLogin\u201d link. Click on that to bring out the HTTP Basic Authentication dialog box that prompts for username/password. Once authenticated, you\u2019ll be back at Trac with \u201cAdmin\u201d link at the top navigation bar.</p><h3>4. Adding Git Repository to Trac</h3><p>Once you have Admin enabled on Trac, it can be all GUI work from now. First you need to enable GitPlugin for Trac.</p><ol><li>Click on \u201cAdmin\u201d at top right.</li><li>Click on \u201cPlugins\u201d on the left navigation menu, under \u201cGeneral\u201d</li><li>Click on \u201cTracGit\u201d in the middle of the page, enable \u201cGitConnector\u201d and Save Change</li></ol><p>Next, you need to add your repositories using the Admin interface.</p><ol><li>Click on \u201cRepositories\u201d on the left navigation menu, under \u201cVersion Control\u201d</li><li>In my lowendscript example, I put<ul><li>Name=<b>lowendscript</b></li><li>Type=<b>git</b></li><li>Directory=<b>/home/git/lowendscript.git</b></li></ul></li><li>Click on Add! And you should now be able to browse your source under \u201cBrowse\u201d</li></ol><p>That\u2019s pretty much it for Trac. It would be a good idea to put that long <code>tracd</code> command in /etc/rc.local so it starts everytime you reboot the VPS.</p><h3>5. SSL + Proxy via Nginx</h3><p>Now, you do want your latest source code browser + bug tracking system behind SSL, right? I found the easiest way to do it is by putting a Nginx proxy in front. Since we already have Nginx installed in step 1, we just need to</p><ul><li>Get a SSL certificate.</li><li>Add Nginx configuration to do the proxy.</li></ul><p>For \u201cfree\u201d SSL certificates, I use <a href=\"http://www.startssl.com/\">StartSSL</a>, which works for most modern browsers. However to make it simple, I am going to use self-signed certificate in this tutorial.</p><pre class=\"code\"># <b>openssl genrsa -out /etc/nginx/ssl.key 1024</b>\nGenerating RSA private key, 1024 bit long modulus\n..............................................++++++\n........................................++++++\ne is 65537 (0x10001)\n# <b>openssl req -new -key /etc/nginx/ssl.key -out /tmp/ssl.csr</b>\n...\nCountry Name (2 letter code) [US]:\nState or Province Name (full name) [Some-State]:\nLocality Name (eg, city) []:\nOrganization Name (eg, company) [Internet Widgits Pty Ltd]:\nOrganizational Unit Name (eg, section) []:\nCommon Name (eg, YOUR name) []:my-gitbox\nEmail Address []:\n\nPlease enter the following 'extra' attributes\nto be sent with your certificate request\nA challenge password []:\nAn optional company name []:\n# <b>openssl x509 -req -days 365 -in /tmp/ssl.csr -signkey /etc/nginx/ssl.key -out /etc/nginx/ssl.crt</b>\nSignature ok\nsubject=/C=US/ST=Some-State/O=Internet Widgits Pty Ltd/CN=my-gitbox\nGetting Private key\n# <b>rm -f /tmp/ssl.csr</b>\n</pre><p>Done. Your self signed SSL key and certificate are now installed. Time to get Nginx to use it. Save the following file to <code>/etc/nginx/sites-enabled/my-gitbox.conf</code>:</p><pre class=\"code\">server {\n    server_name _;\n    listen 443;\n    ssl on;\n    ssl_certificate /etc/nginx/ssl.crt;\n    ssl_certificate_key /etc/nginx/ssl.key;\n\n    location / {\n        proxy_pass http://localhost:8000;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n    }\n    location /trac/chrome/site {\n        rewrite /trac/chrome/site/(.*) /htdocs/$1 break;\n        root    /home/trac/project;\n    }\n}\n</pre><p>Restart Nginx, and now browse to your VPS\u2019s HTTPS port. You\u2019ll see Trac in its SSL glory (well, after bypass the browser\u2019s security check at least).</p><p>Trac also happens to have pretty good Wiki engine, and it has heaps of plugins for customization. With a bit of optimization (most notably <a href=\"/blog/reduce-stack-limit-for-multi-thread-apps/\">reducing the stack size</a> for multi-threaded tracd), you should be able to run the entire stack with less than 80MB on an OpenVZ VPS (and much less on a Xen).</p><p>Now with code repository, bug tracking system and documentation wiki ready, I better get back to do more coding :)</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Frunning-trac-git-hosting-on-a-low-end-vps%2F&amp;t=Running%20Trac%20%2B%20Git%20Hosting%20on%20a%20Low%20End%20VPS\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Running%20Trac%20%2B%20Git%20Hosting%20on%20a%20Low%20End%20VPS&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Frunning-trac-git-hosting-on-a-low-end-vps%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Frunning-trac-git-hosting-on-a-low-end-vps%2F&amp;title=Running%20Trac%20%2B%20Git%20Hosting%20on%20a%20Low%20End%20VPS&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-configure-reverse-proxy-with-nginx/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Configure Reverse Proxy with NGINX\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Configure Reverse Proxy with NGINX</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/from-zero-to-encrypted-with-nginx-and-lets-encrypt/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Free SSL with NGINX and LetsEncrypt on Debian 10\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-and-lets-encrypt-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Free SSL with NGINX and LetsEncrypt on Debian 10</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-set-up-a-node-js-application-for-production-on-a-debian-9-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How To Set Up a Node.js Application for Production on a Debian 9 VPS\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/leb-centered-small.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How To Set Up a Node.js Application for Production on a Debian 9 VPS</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/admin/\" title=\"All posts by LowEndAdmin\" rel=\"author\">LowEndAdmin</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/11a4d9191634a9374eeca7d0e8982ba2?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/11a4d9191634a9374eeca7d0e8982ba2?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">The original owner of LowEndBox known as \"LowEndAdmin\" or \"LEA\" for short founded LowEndBox in 2008 and created the concept of hosting applications on low resource \"Low End Boxes\". After creating the roots of the community that we know today, \"LEA\" stepped aside and allowed others to carry the torch forward.</p></div></div><div class=\"feedback\"></div></div>"}