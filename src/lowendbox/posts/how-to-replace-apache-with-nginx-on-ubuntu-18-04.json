{"id": "19322", "post": "<div class=\"post-19322 post type-post status-publish format-standard hentry category-virtual-servers category-tutorials tag-apache tag-nginx tag-ubuntu tag-ufw-firewall tag-vps\" id=\"post-19322\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/how-to-replace-apache-with-nginx-on-ubuntu-18-04/\" rel=\"bookmark\">How to Replace Apache with NGINX on Ubuntu 18.04</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/apache/\" rel=\"tag\">apache</a>, <a href=\"https://lowendbox.com/tag/nginx/\" rel=\"tag\">nginx</a>, <a href=\"https://lowendbox.com/tag/ubuntu/\" rel=\"tag\">ubuntu</a>, <a href=\"https://lowendbox.com/tag/ufw-firewall/\" rel=\"tag\">UFW Firewall</a>, <a href=\"https://lowendbox.com/tag/vps/\" rel=\"tag\">VPS</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> June 20, 2019 @ 12:43 pm, by Jon Biloh</div><div class=\"storycontent tablelook\"><p>NGINX is the modern web server founded by computer software engineer Igor Sysoev in the year 2004. NGINX is used by the most busiest and high traffic website. NGINX works out of box with the most major web stacks including LEMP (Linux, NGINX, MySQL, PHP) stack. This tutorial assumes that your website is hosted with the Apache web server and you want to migrate to NGINX . The process of migration includes replacing the Apache web server with the NGINX without loosing the website data with less downtime.</p><p><span id=\"more-19322\"></span></p><h2>Why Replace Apache with NGINX ?</h2><p>There are several reasons to replace Apache with NGINX are:</p><ul><li>NGINX is the fastest web server that supports concurrent connections and supports high traffic website load.</li><li>NGINX consumes less RAM and CPU compared to Apache and it is resource friendly.</li><li>NGINX improves performance of website by supporting inbuilt cache system for faster access for website static contents like Images, CSS, JavaScript, etc.</li></ul><h2>What is the major difference between Apache and NGINX?</h2><p>These are the major difference between Apache and NGINX are:</p><ul><li>The main configuration files for Apache and NGINX are located at <strong>/etc/apache2/apache2.conf</strong> and <strong>/etc/nginx/nginx.conf</strong> respectively.</li><li>NGINX uses server block but Apache uses virtual host.</li><li>NGINX and Apache both are using same default root directory <strong>/var/www/html.</strong></li><li>NGINX has inbuilt cache system but Apache don\u2019t have any inbuilt cache system.</li></ul><h2>Pre Requirements</h2><p>Before starting the tutorial you will need:</p><ul><li>You will need a Ubuntu 18.04 VPS with minimum 1GB of RAM for smooth operations.</li><li>The Apache web server must be previously installed on your VPS.</li></ul><h2>Step-1: Remove the Apache Web Server</h2><p>Before installing the NGINX you will remove the Apache web server to avoids conflict between them.</p><p>First of all you will stop the Apache service before removing the Apache web server. This enables us to remove the Apache without any issues.</p><pre>$ sudo systemctl stop apache2</pre><p>After stopping the Apache you will remove the startup Apache entries from systemctl. This enables us to remove the startup entries so that Apache services won\u2019t be automatically started during boot time.</p><pre>$ sudo systemctl disable apache2</pre><p>When Apache services are successfully stopped and startup entries are also remove then it time to remove the Apache web server packages from the system.</p><pre>$ sudo apt remove apache2</pre><p>Above command will remove only apache2 packages on but Apache related dependencies are kept on with system. So it is essential to remove those unwanted dependencies to free your space. This can be run by given command.</p><pre>$ sudo apt autoremove</pre><p>Now, the Apache web server has successfully removed. The installation of NGINX is described in the next step.</p><h2>Step-2: Install the NGINX Web Server</h2><p>Let\u2019s begin with the installation of NGINX on Ubuntu. The Ubuntu default repository contains all the packages of NGINX. Installation is straight forward so you have to install it without any hassle using apt package manager.</p><p>First remove and flush the old apt repository cache then update the repository to load latest packages information and perform a full upgrade to upgrade all the installed packages.</p><pre>$ sudo apt clean all &amp;&amp; sudo apt update &amp;&amp; sudo apt dist-upgrade</pre><p>After updating the repository it is the right time to install the updated NGINX packages.</p><pre>$ sudo apt install nginx</pre><p>When NGINX has successfully installed then Let\u2019s begin with the next step that will guide you firewall configuration for NGINX web server.</p><h2>Step-3: Configure UFW Firewall</h2><p>The NGINX web server requires HTTP Port that is Port No. 80 and HTTPS port that is Port No. 443 to successfully work with firewall. So it is essential to keep this port open for that purpose so that NGINX works flawlessly. The UFW (Unified Firewall) is the default firewall for Ubuntu 18.04 Linux distribution. Hence, you will add firewall rules to allow HTTP and HTTPS ports.</p><p>By Default there is no rules are added to UFW firewall so it is so easy to add those rules. You are required to add the HTTP and HTTPS port rules to UFW firewall this can be done by simple commands. The NGINX Full rules contains both the HTTP and HTTP ports and this will allow these ports to be kept open by the UFW firewall.</p><pre>$ sudo ufw allow \"Nginx Full\"</pre><p>After adding the firewall rules its time to check the rules which had been added or updated using these rules using status command.</p><pre>$ sudo ufw status</pre><p>The above command show given sample output.</p><pre>Status: active\n\nTo Action From\n-- ------ ----\n80/tcp ALLOW Anywhere\n443/tcp ALLOW Anywhere\n22/tcp LIMIT Anywhere\nNginx Full ALLOW Anywhere\n80/tcp (v6) ALLOW Anywhere (v6)\n443/tcp (v6) ALLOW Anywhere (v6)\n22/tcp (v6) LIMIT Anywhere (v6)\nNginx Full (v6) ALLOW Anywhere (v6)</pre><p>Above output shows that you have successfully added the firewall rules and you ready to move forward to configure the NGINX web server that is described in next step.</p><h2>Step-4: Understanding the Configuration File of NGINX Web Server Compared to Apache Web Server</h2><p>The configuration of NGINX are almost same like Apache web server but the structure and syntax is different referred to configuration files. This Difference between the&nbsp;can be understand by the given sample configuration file of Apache and NGINX</p><p>Sample Apache Configuration file is located at <strong>/etc/apache2/sites-available/example.com.conf</strong></p><pre>&lt;VirtualHost *:80&gt;\nServerName example.com\nServerAlias www.example.com\nServerAdmin admin@example.com\nDocumentRoot /var/www/html/\n&lt;/VirtualHost&gt;\n\n&lt;Directory /var/www/html&gt;\nRequire all granted\nAllowOverride None\n&lt;/Directory&gt;</pre><p>Sample NGINX Configuration file is located at <strong>/etc/nginx/sites-available/example.com.conf</strong></p><pre>server {\nlisten 80;\nserver_name example.com www.example.com;\nroot /var/www/html;\n\nlocation / {\ntry_files $uri $uri/ =404;\n}\n}</pre><p>If you look carefully from the both the configuration files you will find that Apache configuration file are expressed in virtual host and NGINX configuration file are expressed in server block. After understanding the difference between the configuration file of Apache and NGINX. Now, you ready to configure the rest of the NGINX configuration files that is described in next step.</p><h2>Step-5: Configure NGINX Web Server</h2><p>The NGINX has same capabilities like Apache web server but it has faster support of concurrent connections. The configuration file of NGINX uses the server blocks in configuration. You have to configure it wheres the same location of document root where all your static web assets like HTML, CSS, JavaScript and Images are stored.</p><blockquote><p>Note: In this guide we throughout assume that your document root is <strong>/var/www/html</strong> and default domain name is <strong>example.com</strong></p></blockquote><p>In Ubuntu, the NGINX Server Blocks are located at <strong>sites-available</strong> and <strong>sites-enabled</strong> directory inside the NGINX configuration directory. You will edit the server blocks files located in <strong>/etc/nginx/sites-available/</strong> and you will be create one for enabling the server blocks for your domain. This method is highly recommended because it allows you to host more than one website and at different domains and files locations on your Ubuntu.</p><pre>$ sudo nano /etc/nginx/sites-available/example.com.conf</pre><p>Add the given lines and don\u2019t forget to replace <strong>example.com</strong> and <strong>www.example.com</strong> with your base domain name and subdomain to enable server blocks for NGINX.</p><pre>server { \nlisten 80; \nserver_name example.com www.example.com; \nroot /var/www/html; \n\nlocation / { \ntry_files $uri $uri/ =404; \n} \n}</pre><p>When you will completely add all of these lines then hit <strong>Ctrl</strong> + <strong>O</strong> to save and <strong>Ctrl</strong> + <strong>X</strong> to exit from nano text editor.</p><p>In NGINX server blocks configuration files you will create the symbolic link using soft links between <strong>sites-available</strong> and <strong>sites-enabled</strong> directory. Soft links allows you whenever you will make changes to server blocks configuration file located in <strong>sites-available</strong> directory and it will immediately replicated to&nbsp;<strong>sites-enabled</strong> directory.</p><pre>$ sudo ln -s /etc/nginx/sites-available/example.com.conf /etc/nginx/sites-enabled/example.com.conf</pre><p>You will check for correct syntax and to avoid any error present in NGINX configuration files. This command will also tells you where you have errors are present.</p><pre>$ sudo nginx -t</pre><p>When all syntax is correct then it will shows you <strong>Syntax OK</strong> as a output. If any thing goes wrong please re-check NGINX server blocks files. When all steps are completed then restart the services for making changes in the effect.</p><pre>$ sudo systemctl restart nginx</pre><p>After all things are ready then you will change the permission for default NGINX user <strong>www-data</strong> to enable read, write and execute permissions for default web root directory.</p><pre>$ sudo chown www-data:www-data /var/www/html</pre><p>To verify whether the <strong>www-data</strong> user and groups are owned the default web root directory by running the given long listing command</p><pre>$ ll /var/www/html</pre><p>After running this command the output shows <strong>www-data</strong> user and group is owned by the default web root directory <strong>/var/www/html</strong> . This means default NGINX user <strong>www-data</strong> will able to read, write and execute the default web root directory.</p><h2>Conclusion</h2><p>Lastly, you have successfully replaced the Apache to NGINX. Now you will ready to use the NGINX for your web property to enable fast access to web assets and low memory foot-printing. In the end, the NGINX can be used for various proposes and it can be used for both static and dynamic websites. For more information regarding the NGINX refer the man pages available in Ubuntu.</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fhow-to-replace-apache-with-nginx-on-ubuntu-18-04%2F&amp;t=How%20to%20Replace%20Apache%20with%20NGINX%20on%20Ubuntu%2018.04\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=How%20to%20Replace%20Apache%20with%20NGINX%20on%20Ubuntu%2018.04&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fhow-to-replace-apache-with-nginx-on-ubuntu-18-04%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fhow-to-replace-apache-with-nginx-on-ubuntu-18-04%2F&amp;title=How%20to%20Replace%20Apache%20with%20NGINX%20on%20Ubuntu%2018.04&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-set-up-nameservers-on-a-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Set Up Nameservers on a VPS\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/how-to-setup-nameservers-on-a-vps-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Set Up Nameservers on a VPS</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-configure-reverse-proxy-with-nginx/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Configure Reverse Proxy with NGINX\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Configure Reverse Proxy with NGINX</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/top-ten-ways-to-save-on-vps-hosting-and-a-bonus-eleventh-way/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndBox - The best place for hosting and cheap VPS deals!\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Top Ten Ways to Save on VPS Hosting (and a Bonus Eleventh Way)</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/jbiloh/\" title=\"All posts by Jon Biloh\" rel=\"author\">Jon Biloh</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/f766d6dc4b5f406b9f3cb0339d48de95?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/f766d6dc4b5f406b9f3cb0339d48de95?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/jbiloh\" class=\"bio-icon bio-icon-website\"></a><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"http://Jbiloh\" class=\"bio-icon bio-icon-twitter\"></a><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.linkedin.com/in/jon-biloh-4b32598/\" class=\"bio-icon bio-icon-linkedin\"></a><p class=\"bio-description\">I'm Jon Biloh and I own LowEndBox and LowEndTalk. I've spent my nearly 20 year career in IT building companies and now I'm excited to focus on building and enhancing the community at LowEndBox and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}