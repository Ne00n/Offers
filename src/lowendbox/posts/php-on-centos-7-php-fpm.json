{"id": "7787", "post": "<div class=\"post-7787 post type-post status-publish format-standard hentry category-tutorials tag-tutorial tag-tutorials-2\" id=\"post-7787\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/php-on-centos-7-php-fpm/\" rel=\"bookmark\">PHP on CentOS 7 (PHP-FPM)</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a>, <a href=\"https://lowendbox.com/tag/tutorials-2/\" rel=\"tag\">tutorials</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> October 5, 2015 @ 1:00 pm, by Maarten Kossen</div><div class=\"storycontent tablelook\"><p style=\"text-align: center;\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzEiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCAyNzEgNzAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNjZmQ0ZGIiLz48L3N2Zz4=\" loading=\"lazy\" class=\"alignnone size-full wp-image-3957\" data-src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" alt=\"lowendtutorial\" width=\"271\" height=\"70\"></p><p>Welcome back! This week\u2019s tutorial will focus on installing PHP on CentOS 7 and will continue were I left off last time: with the <a href=\"https://lowendbox.com/blog/nginx-on-centos-7/\">installation of NGINX</a>. The last tutorial is a prerequisite for this one, so if you haven\u2019t followed that one yet, now is the time to do so.</p><p>We\u2019re not going to \u201cjust\u201d install PHP, though. We want to do it right. First of all, we\u2019re going to install PHP-FPM so PHP can run as a separate process rather than embedded in the web server process. This has been the best practice for a while now, though it\u2019s a little harder to set up than the \u201cold way\u201d. There\u2019s plenty of advantages to this set-up, but PHP running as a separate process is the biggest one.</p><p>Second, CentOS ships an <em>unsupported</em> and <em>outdated</em> version of PHP. PHP 5.4 is the version that comes with CentOS 7 (or actually: the EPEL repository) and that version is no longer being maintained. Therefore we\u2019re going to install PHP 5.6 from a different repository. This will not only give you all the latest features, but also a version that still received security patches.</p><p>So, let\u2019s get started!</p><p><span id=\"more-7787\"></span></p><h2>Preparing your environment</h2><p>First let\u2019s start by ensuring your system is up-to-date. This will not only update any packages that may have an update pending, but will also update the repository caches ensuring that any packages added meanwhile have been added:</p><blockquote><p>sudo yum update</p></blockquote><p>When is asks you to continue, please type \u2018y\u2019 to ensure everything gets updated properly.</p><p>Now, in order to get any sort of decent version of PHP (in other words: one that is still receiving security updates), we need to add a third-party repository that has up-to-date packages. There\u2019s a nice French guy called Remi that maintains PHP repositories for a number of PHP versions and has been doing so for years. They\u2019re free to use and well-documented. You can read more about these repositories on <a href=\"http://blog.famillecollet.com/\">his website</a>.</p><p>To add his PHP repository, run the following command:</p><blockquote><p>sudo yum install http://rpms.remirepo.net/enterprise/remi-release-7.rpm</p></blockquote><p>This pulls in the package and adds the repository to YUM. It is being added disabled, though, so we have to enable that manually. So, open the repository file:</p><blockquote><p>sudo vi /etc/yum.repos.d/remi.repo</p></blockquote><p>And locate these two blocks of text:</p><blockquote><p>[remi]<br>\nname=Remi\u2019s RPM repository for Enterprise Linux 7 \u2013 $basearch<br>\n#baseurl=http://rpms.remirepo.net/enterprise/7/remi/$basearch/<br>\nmirrorlist=http://rpms.remirepo.net/enterprise/7/remi/mirror<br>\nenabled=0<br>\ngpgcheck=1<br>\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</p><p>\u2026</p><p>[remi-php56]<br>\nname=Remi\u2019s PHP 5.6 RPM repository for Enterprise Linux 7 \u2013 $basearch<br>\n#baseurl=http://rpms.remirepo.net/enterprise/7/php56/$basearch/<br>\nmirrorlist=http://rpms.remirepo.net/enterprise/7/php56/mirror<br>\n# WARNING: If you enable this repository, you must also enable \u201cremi\u201d<br>\nenabled=0<br>\ngpgcheck=1<br>\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</p></blockquote><p>I\u2019ve cut out the \u2018remi-php55\u2019 block as we want PHP 5.6 and not PHP 5.5. Now, in order to enable this repository, you have to change \u2018enabled=0\u2019 into \u2018enabled=1\u2019. This means that after the change the blocks look like this:</p><blockquote><p>[remi]<br>\nname=Remi\u2019s RPM repository for Enterprise Linux 7 \u2013 $basearch<br>\n#baseurl=http://rpms.remirepo.net/enterprise/7/remi/$basearch/<br>\nmirrorlist=http://rpms.remirepo.net/enterprise/7/remi/mirror<br>\nenabled=1<br>\ngpgcheck=1<br>\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</p><p>\u2026</p><p>[remi-php56]<br>\nname=Remi\u2019s PHP 5.6 RPM repository for Enterprise Linux 7 \u2013 $basearch<br>\n#baseurl=http://rpms.remirepo.net/enterprise/7/php56/$basearch/<br>\nmirrorlist=http://rpms.remirepo.net/enterprise/7/php56/mirror<br>\n# WARNING: If you enable this repository, you must also enable \u201cremi\u201d<br>\nenabled=1<br>\ngpgcheck=1<br>\ngpgkey=file:///etc/pki/rpm-gpg/RPM-GPG-KEY-remi</p></blockquote><p>Save the file. You are now ready to install PHP-FPM!</p><h2>Installation</h2><p>In order to install PHP-FPM (and not the PHP package that pulls in Apache as a dependency), run the following command:</p><blockquote><p>sudo yum install php-fpm</p></blockquote><p>It again asks you if you want to continue. Several other packages have been selected as well as dependencies. Type \u2018y\u2019 again to start the installation.</p><p>Once the installation is finished, PHP-FPM will have been installed but is not yet running. In order to start it, type:</p><blockquote><p>sudo systemctl start php-fpm</p></blockquote><p>To ensure it also starts automatically with the server, run the following command:</p><blockquote><p>sudo systemctl enable php-fpm</p></blockquote><p>Now we need to ensure that NGINX knows to send PHP-requests to PHP-FPM. For this to work we need to add a configuration block to the default host. For reasons beyond my understanding this was set up a bit \u201cdifferent\u201d on CentOS, so if you\u2019re looking for logic stop trying. In any case, fire up a new file:</p><blockquote><p>sudo vi /etc/nginx/default.d/php-fpm.conf</p></blockquote><p>And add the following content to it:</p><blockquote><p># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000<br>\n#<br>\nlocation ~ \\.php$ {<br>\nroot&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /usr/share/nginx/html;<br>\nfastcgi_pass&nbsp;&nbsp; 127.0.0.1:9000;<br>\nfastcgi_index&nbsp; index.php;<br>\nfastcgi_param&nbsp; SCRIPT_FILENAME&nbsp;&nbsp; $document_root$fastcgi_script_name;<br>\ninclude&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; fastcgi_params;<br>\n}</p></blockquote><p>This block tells NGINX to pass on any request going to a file ending with .php to 127.0.0.1 port 9000, which is where PHP-FPM runs. NGINX does this using FastCGI. The configuration block includes default configuration we won\u2019t touch for now.</p><p>With these contents in the file, save the file, and restart NGINX:</p><blockquote><p>sudo systemctl restart NGINX</p></blockquote><p>You\u2019re now set to test PHP. We\u2019re going to do that by displaying phpinfo on your server. <strong>Remember to remove the test file after the tutorial as it displays quite some server and environment information!</strong></p><p>Open up a new file:</p><blockquote><p>sudo vi /usr/share/nginx/html/info.php</p></blockquote><p>And add the following contents to it:</p><blockquote><p>&lt;?php phpinfo();</p></blockquote><p>Save the file.</p><p>If you now go to your server IP address or hostname <em>plus</em> \u201c/info.php\u201d (example: http://192.0.2.1/info.php) you should see an nice and shiny (or well, purple and ugly) page with information about PHP and your server!</p><hr><p>That\u2019s it for this time! Up next is your usual suspect: MySQL!</p><p>&nbsp;</p><p>&nbsp;</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fphp-on-centos-7-php-fpm%2F&amp;t=PHP%20on%20CentOS%207%20%28PHP-FPM%29\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=PHP%20on%20CentOS%207%20%28PHP-FPM%29&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fphp-on-centos-7-php-fpm%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fphp-on-centos-7-php-fpm%2F&amp;title=PHP%20on%20CentOS%207%20%28PHP-FPM%29&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Keeping A (log)Watchful Eye on Your VPS With logwatch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/logwatch-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Keeping A (log)Watchful Eye on Your VPS With logwatch</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/mpkossen/\" title=\"All posts by Maarten Kossen\" rel=\"author\">Maarten Kossen</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">Maarten Kossen was the administrator of LowEndBox from 2013 to 2015, and brought many ideas and improvements to the website during his leadership. Today he is member of our community and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}