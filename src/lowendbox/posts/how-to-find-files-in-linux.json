{"id": "23457", "post": "<div class=\"post-23457 post type-post status-publish format-standard hentry category-tutorials tag-debian tag-files tag-filesystem tag-find tag-linux tag-sysadmin tag-tutorial tag-utilities tag-utility\" id=\"post-23457\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/how-to-find-files-in-linux/\" rel=\"bookmark\">How to Find Files in Linux</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/debian/\" rel=\"tag\">debian</a>, <a href=\"https://lowendbox.com/tag/files/\" rel=\"tag\">files</a>, <a href=\"https://lowendbox.com/tag/filesystem/\" rel=\"tag\">filesystem</a>, <a href=\"https://lowendbox.com/tag/find/\" rel=\"tag\">find</a>, <a href=\"https://lowendbox.com/tag/linux/\" rel=\"tag\">linux</a>, <a href=\"https://lowendbox.com/tag/sysadmin/\" rel=\"tag\">sysadmin</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a>, <a href=\"https://lowendbox.com/tag/utilities/\" rel=\"tag\">utilities</a>, <a href=\"https://lowendbox.com/tag/utility/\" rel=\"tag\">utility</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> May 15, 2021 @ 7:09 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a target=\"_blank\" rel=\"noopener noreferrer\"><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2020/05/Finding-files-in-linux.jpg.webp\" loading=\"lazy\" class=\"screenshot litespeed-loaded\" title=\"How to Find Files in Linux\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/Finding-files-in-linux.jpg.webp\" alt=\"How to Find Files in Linux\" width=\"410\" height=\"230\" data-was-processed=\"true\"></a><br>\nThere\u2019s nothing more frustrating than knowing that a file exists on your system but not knowing where it is. It\u2019s like losing your car keys or misplacing your phone.</p><p>Sometimes you\u2019ll have contextual clues \u2013 for example, system configuration files are usually in /etc. But even there, you\u2019ve got 253 directories and subdirectories and over 1,730 files.</p><p>Let\u2019s look at some tools to make find files easier.</p><h1>Setting Up a VPS</h1><p>I\u2019ve setup a Debian 10 VPS and done the following:</p><ul><li>created two users, named frank and mary</li><li>in /home/mary, I\u2019ve created a directory called diary, placed some files in it (entry1.txt, entry2.txt, etc.), and made it mode 700 so only mary (and root) could see files in that directory.</li><li>in /home/frank, I created files called \u201cplan1.txt\u201d and \u201cplan2.txt\u201d, both of which are mode 600, so only frank (and root) can see them.</li></ul><p><span id=\"more-23457\"></span></p><h1>The mlocate package</h1><p>mlocate (Merging Locate) is a package that builds a global database of files that can be queried to find files. locate has a long history in Unix (1982). slocate was an improvement on locate and mlocate is a further improvement which seeks to operate more quickly and not blow up the filesystem cache when it updates.</p><p>mlocate also only shows files that are available to the user, not all files. All these programs run as unpriveleged users, so you needn\u2019t worry that user A is going to see user B\u2019s file called /home/userb/my-secret-diary.txt</p><p>To install on Debian:</p><pre>apt-get install mlocate</pre><p>When installed, the database is empty, so trying to use the locate command produces an error:</p><pre>root@vnc:~# locate hosts\nlocate: can not stat () `/var/lib/mlocate/mlocate.db': No such file or directory</pre><p>Let\u2019s get the database up to date:</p><pre># time updatedb\n\nreal 0m0.593s\nuser 0m0.018s\nsys 0m0.112s</pre><p>On an AMD EPYC 7601 with 25GB RAID SSD disk that 95% free, updating the database takes less than a second. For comparison, on 6TB of spinning disk RAID-1 on less-than-enterprise-grade storage with an i3 on my home fileserver, updating the database can take several minutes.</p><p>Let\u2019s see what the mlocate database looks like:</p><pre>root@vnc:~# locate -S\nDatabase /var/lib/mlocate/mlocate.db:\n3,260 directories\n33,859 files\n1,433,462 bytes in file names\n640,990 bytes used to store database</pre><p>Now that we\u2019re up to date, I can query. As root:</p><pre>root@vnc:~# locate hosts\n/etc/hosts\n/etc/hosts.allow\n/etc/hosts.deny\n/usr/lib/x86_64-linux-gnu/security/pam_rhosts.so\n/usr/share/man/man5/hosts.5.gz\n/usr/share/man/man5/hosts.allow.5.gz\n/usr/share/man/man5/hosts.deny.5.gz\n/usr/share/man/man5/hosts.equiv.5.gz\n/usr/share/man/man5/hosts_access.5.gz\n/usr/share/man/man5/hosts_options.5.gz\n/usr/share/man/man8/pam_rhosts.8.gz\n/usr/share/vim/vim81/ftplugin/denyhosts.vim\n/usr/share/vim/vim81/ftplugin/hostsaccess.vim\n/usr/share/vim/vim81/syntax/denyhosts.vim\n/usr/share/vim/vim81/syntax/hostsaccess.vim\n/usr/share/zsh/vendor-completions/_sd_hosts_or_user_at_host</pre><p>If I wanted to do a case-insensitive locate, I could use locate -i.</p><p>Because I\u2019m root, I can see files in mary\u2019s home directory:</p><pre># locate entry1.txt\n/home/mary/diary/entry1.txt</pre><p>But if I\u2019m frank, I cannot:</p><pre># su - frank\n$ locate entry1.txt\n$</pre><p>updatedb will run nightly to update out of /etc/cron/cron.daily/mlocate.</p><p>One weakness of locate is that if you create a file during the day, you have to wait until the overnight run of updatedb (or run it manually) before the file is in the database. For real-time queries, we can use find.</p><h1>Using find</h1><p>Find is a very old Linux command that goes back to Unix version 5 (1978!). It does a real-time search of filesystems. Unlike locate, you can search with criteria besides just a name.</p><p>The general format for find is</p><pre>find PATH EXPRESSIONS... ACTIONS...</pre><p>Let\u2019s say I wanted to find /etc/passwd. I would type:</p><pre>find /etc -name passwd -print</pre><p>This means</p><ul><li>\u201cgo look in the /etc directory and all its subdirectories\u201d</li><li>\u201cmatch files named \u2018passwd'\u201d</li><li>\u201cprint out each file you find\u201d</li></ul><p>Here are the results:</p><pre># find /etc -name passwd -print\n/etc/pam.d/passwd\n/etc/cron.daily/passwd\n/etc/passwd\n#</pre><p>The -print is optional so if you leave it off, you\u2019ll get the same result.</p><p>Of course, I may not know the directory, so I could run this against the root filesystem:</p><pre># find / -name passwd -print\n/etc/pam.d/passwd\n/etc/cron.daily/passwd\n/etc/passwd\n/usr/bin/passwd\n/usr/share/doc/passwd\n/usr/share/lintian/overrides/passwd\n/usr/share/bash-completion/completions/passwd\n#</pre><p>-iname is the case-insensitive parallel to -name.</p><p>With find, I can also find based on other criteria. Some examples to whet your appetite:</p><pre># dd if=/dev/zero of=/root/bigfile bs=1048576 count=512\n512+0 records in\n512+0 records out\n536870912 bytes (537 MB, 512 MiB) copied, 0.490124 s, 1.1 GB/s\n# find / -size +100M -print\n/proc/kcore\nfind: \u2018/proc/2381/task/2381/fd/6\u2019: No such file or directory\nfind: \u2018/proc/2381/task/2381/fdinfo/6\u2019: No such file or directory\nfind: \u2018/proc/2381/fd/5\u2019: No such file or directory\nfind: \u2018/proc/2381/fdinfo/5\u2019: No such file or directory\n/root/bigfile</pre><p>Here I\u2019ve created a 512MB file and then searched for files bigger than 100M (\u201c-size +100M\u201d). The errors are because I asked find to search root and that includes /proc, and during find\u2019s run some processes that were running when it started finished and their files no longer existed.</p><p>I can also find files based on date:</p><pre># mkdir /backup\n# touch -t 201008201111 /backup/some_old_backup.tar.gz\n# touch /backup/current_backup.tar.gz\n# ll /backup\ntotal 8\ndrwxr-xr-x 2 root root 4096 May 24 18:42 .\ndrwxr-xr-x 19 root root 4096 May 24 18:40 ..\n-rw-r--r-- 1 root root 0 May 24 18:42 current_backup.tar.gz\n-rw-r--r-- 1 root root 0 Aug 20 2010 some_old_backup.tar.gz\n# find /backup -mtime +30 -print\n/backup/some_old_backup.tar.gz</pre><p>That find expression (\u201c-mtime +30\u201d) menas \u201colder than 30 days\u201d.</p><p>There is much more you can do with find \u2013 for example, printing is not the only action. There are also a galaxy of expressions you can use to seach by: owner, group owner, newer than or older than other files, type of file, etc. Consult the find man page to learn all about find.</p><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendboxtv-building-a-highly-available-wordpress-site-part-2-configuring-the-nodes/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndBoxTV: Building a Highly Available WordPress Site, Part 2: Configuring the Nodes\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/05/WP-HA-2-leb-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndBoxTV: Building a Highly Available WordPress Site, Part 2: Configuring the Nodes</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/patch-your-exim-installs-21-nails-vulnerability/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Patch Your Exim Installs: 21 Nails Vulnerability\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/05/exim_300-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Patch Your Exim Installs: \"21 Nails\" Vulnerability</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendboxtv-building-a-highly-available-wordpress-site-part-1/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndBoxTV: Building a Highly Available WordPress Site, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/05/WP-HA-1-leb-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndBoxTV: Building a Highly Available WordPress Site, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/cwvps-50-off-linux-and-windows-kvm-vps-offers-with-unmetered-bandwidth-in-8-locations/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"CWVPS: 50% OFF Linux and Windows KVM VPS Offers with Unmetered Bandwidth in 8 Locations\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/04/cheapwindowsvps-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">CWVPS: 50% OFF Linux and Windows KVM VPS Offers with Unmetered Bandwidth in 8 Locations</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}