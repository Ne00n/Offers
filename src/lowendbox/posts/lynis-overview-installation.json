{"id": "18693", "post": "<div class=\"post-18693 post type-post status-publish format-standard hentry category-tutorials tag-lynis tag-lynis-installation tag-lynis-overview\" id=\"post-18693\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/lynis-overview-installation/\" rel=\"bookmark\">Lynis Overview &amp; Installation</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/lynis/\" rel=\"tag\">lynis</a>, <a href=\"https://lowendbox.com/tag/lynis-installation/\" rel=\"tag\">lynis installation</a>, <a href=\"https://lowendbox.com/tag/lynis-overview/\" rel=\"tag\">lynis overview</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> April 8, 2019 @ 9:29 am, by Frank Williams</div><div class=\"storycontent tablelook\"><div class=\"section post-body\"><p>Once a server is installed, you will want to keep a regular watch for points of vulnerability. Having a security auditing application will make this an easier task. Lynis is open source, server-based application that evaluates it for vulnerabilities and generates a report with the suggestions. You can then evaluate this and make necessary changes.</p><p>Before we get started, I must point out that security auditing takes a bit of time to review, revise and fine-tune before you get to the Goldilocks zone (neither too permissive nor too restrictive).</p><h2>Why Lynis (Or Any Security Auditor for That Matter)?</h2><p>One of the prime reasons you will need Lynis is to get compliance certified. By running a security audit you can prove to auditors that all necessary steps required for compliance are met. Other use cases for running Lynis are</p><ul><li>Security auditing</li><li>Penetration testing</li><li>Vulnerability detection</li><li>System hardening</li></ul><p>Lynis works on almost all UNIX based systems (including systems such as Raspberry Pi).</p><p><span id=\"more-18693\"></span></p><h2>How It Works</h2><p>Lynis works by identifying current components, applications and services and digging in further. This means that no additional installation of components. For e.g., if it detects the presence of MySQL, it will try to check if root user has an empty password. If yes, reports it. Likewise, each application or service has a list of tests that are performed against.</p><p>Some of the key controls validated include Authentication (checking for empty passwords, multiple root user IDs), certificate expiry, web services (missing error logs for nginx, for e.g.) and so on.</p><p>A typical scan involves the following</p><ul><li>Initialization</li><li>Perform basic checks, such as file ownership</li><li>Determine operating system and tools</li><li>Search for available software components</li><li>Check latest Lynis version</li><li>Run enabled plugins</li><li>Run security tests per category</li><li>Perform execution of your custom tests (optional)</li><li>Report status of security scan</li></ul><p>The report is displayed online and the scan log is also reported in a log file (lynis.log). Throughout the test process, Lynis runs hundreds of tests (mainly shell scripts) and is based on a given set of controls. Each test has a unique identifier. For e.g., the empty root password is control DBS-1816 Lynis is extensible, which means you can write your own controls.</p><p>It also means that the controls can be enabled or disabled based on your system needs. Tests run are defined based on profiles found in the folder&nbsp;/etc/lynis. The default is&nbsp;/etc/lynis/default.prf. If you want to skip a test create a&nbsp;custom.prf&nbsp;file. If you want to bypass the checks for HTTP servers nginx and apache, add the following entries</p><pre><strong># contents of /etc/lynis/custom.prf</strong>\n\n<strong># Check if nginx is installed</strong>\n\n<strong>skip-test=HTTP-6622</strong>\n\n<strong># Check if apache is installed</strong>\n\n<strong>skip-test=HTTP-6702</strong></pre><h1>Installation &amp; Execution</h1><p>Lynis is available as a package for most linux distributions and installation is a single command</p><pre><strong># yum install lynis       # CentOS/RHEL</strong>\n\n<strong># apt-get install lynis   # Ubuntu/Debian</strong></pre><p>Running Lynis is as easy as running</p><pre><strong># lynis audit system</strong></pre><p>Or</p><pre><strong># lynis audit system --quick</strong></pre><p>(use the second one if you want to run a quick scan)</p><p>Other commands available are</p><table><tbody><tr><td width=\"162\"><strong>Command</strong></td><td width=\"450\"><strong>Description</strong></td></tr><tr><td width=\"162\">audit system</td><td width=\"450\">Perform a system audit</td></tr><tr><td width=\"162\">show commands</td><td width=\"450\">Show available Lynis commands</td></tr><tr><td width=\"162\">show help</td><td width=\"450\">Provide a help screen</td></tr><tr><td width=\"162\">show profiles</td><td width=\"450\">Display discovered profiles</td></tr><tr><td width=\"162\">show settings</td><td width=\"450\">List all active settings from profiles</td></tr><tr><td width=\"162\">show version</td><td width=\"450\">Display current Lynis version</td></tr></tbody></table><p>The output from Lynis can be investigated further using the test ID</p><p>For e.g., if the output shows this</p><pre><strong>! Reboot of system is most likely needed [KRNL-5830]</strong>\n\n<strong>- Solution : reboot</strong>\n\n<strong>https://cisofy.com/controls/KRNL-5830/</strong></pre><p>You can find more about KRNL-5830 by</p><pre><strong># lynis show details KRNL-5830</strong></pre><h1>Conclusion</h1><p>Lynis by default starts with running a lot of tests, as I mentioned earlier, you can skip some of them based on the custom profile. I would also advice to run this as a cronjob (daily/weekly) and review the audit logs on a regular basis.</p></div><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Flynis-overview-installation%2F&amp;t=Lynis%20Overview%20%26%20Installation\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Lynis%20Overview%20%26%20Installation&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Flynis-overview-installation%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Flynis-overview-installation%2F&amp;title=Lynis%20Overview%20%26%20Installation&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/lowendboxwriter/\" title=\"All posts by Frank Williams\" rel=\"author\">Frank Williams</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/8947063acd5819620902a7f05b9ed6a9?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/8947063acd5819620902a7f05b9ed6a9?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">Frank Williams is the pen-name for our offer review and publishing team. For questions or inquiries please contact our Help Desk.</p></div></div><div class=\"feedback\"></div></div>"}