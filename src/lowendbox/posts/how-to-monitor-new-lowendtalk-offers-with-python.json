{"id": "24327", "post": "<div class=\"post-24327 post type-post status-publish format-standard hentry category-tutorials tag-lowendtalk tag-offers tag-python tag-rss tag-web-scraping\" id=\"post-24327\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/how-to-monitor-new-lowendtalk-offers-with-python/\" rel=\"bookmark\">How to Monitor New LowEndTalk Offers with Python</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/lowendtalk/\" rel=\"tag\">lowendtalk</a>, <a href=\"https://lowendbox.com/tag/offers/\" rel=\"tag\">offers</a>, <a href=\"https://lowendbox.com/tag/python/\" rel=\"tag\">python</a>, <a href=\"https://lowendbox.com/tag/rss/\" rel=\"tag\">rss</a>, <a href=\"https://lowendbox.com/tag/web-scraping/\" rel=\"tag\">web scraping</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> February 4, 2021 @ 12:00 am, by raindog308</div><div class=\"storycontent tablelook\"><p>In July 2020, there was a <a href=\"https://www.lowendtalk.com/discussion/165971/alert#latest\">discussion on LowEndTalk</a> about how to monitor new offers on LET.&nbsp; Several solutions were posted, but I think the easiest is to parse LET\u2019s RSS feed.&nbsp; In this tutorial, we\u2019ll show you a simple script you can use to get an email alert when new offers are posted on LowEndTalk.</p><p><em>Although LowEndTalk and LowEndBox are related, not all providers post on both sites so it\u2019s worth watching both for offers!</em></p><h1>Prerequisites</h1><p>I\u2019m running this on a Debian 9 box at home.&nbsp; The system is configured for relay mail via Amazon SES, so my script can just drop mail on the localhost\u2019s port 25.&nbsp; If you need to connect directly to GMail or another mail service, you\u2019ll need to use HTTPS, your password, etc. but the script is easy to fix up and I\u2019ll link below.</p><p>Note that this script is written for Python 3.&nbsp; If you\u2019re using Python 2, it should probably work as-is but I have not checked.&nbsp; Note that on your distro, Python 3 might appear as either /usr/bin/python3 or just /usr/bin/python.</p><p>I\u2019m using the feedparser module, so you\u2019ll need to:</p><pre>pip3 install feedparser\n\n</pre><p><span id=\"more-24327\"></span></p><h1>The Script</h1><pre class=\"p1\"><span class=\"s1\">#!/usr/bin/python3</span>\n<span class=\"s1\">\nimport os, </span><span class=\"s1\">feedparser, </span><span class=\"s1\">smtplib, ssl</span>\n<span class=\"s1\">from email.mime.text import MIMEText</span>\n<span class=\"s1\">from email.mime.multipart import MIMEMultipart</span>\n\n<span class=\"s1\">cache_file = os.environ['HOME'] + \"/.let_offers\"</span>\n<span class=\"s1\">sender_email = \"someone@example.com\"</span>\n<span class=\"s1\">receiver_email = \"someone@example.com\"</span>\n\n<span class=\"s1\">offers_seen = []</span>\n<span class=\"s1\">notifications = []</span>\n\n<span class=\"s1\">if ( os.path.exists(cache_file) == True ):</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; </span>with open(cache_file) as fh:</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; &nbsp; &nbsp; </span>offers_seen = [line.rstrip() for line in fh]</span>\n\n<span class=\"s1\">NewsFeed = feedparser.parse(\"https://www.lowendtalk.com/categories/offers.rss\")</span>\n<span class=\"s1\">for entry in NewsFeed.entries:</span>\n<span class=\"s1\">    if ( entry.link not in offers_seen ):</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; &nbsp; &nbsp; </span>notifications.append(entry)</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; &nbsp; &nbsp; </span>fh = open(cache_file,\"a\")</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; &nbsp; &nbsp; </span>fh.write(entry.link + \"\\n\")</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; &nbsp; &nbsp; </span>fh.close()</span>\n\n<span class=\"s1\">if ( len(notifications) &gt; 0 ):</span>\n<span class=\"s1\">    message = MIMEMultipart(\"alternative\")</span>\n<span class=\"s1\">    message[\"Subject\"] = \"New LET Offers!\"</span>\n<span class=\"s1\">    message[\"From\"] = sender_email</span>\n<span class=\"s1\">    message[\"To\"] = receiver_email</span>\n<span class=\"s1\">    html = \"&lt;html&gt;&lt;body&gt;\"</span>\n<span class=\"s1\">    html += \"&lt;h1&gt;There are new LET offers!&lt;/h1&gt;\"</span>\n<span class=\"s1\">    for notification in notifications:</span>\n<span class=\"s1\">    <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>html += \"&lt;br /&gt;\"</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">      &nbsp; </span>html += \"&lt;p&gt;&lt;a href=\\\"\" + notification.link + \"\\\"&gt;\"</span>\n<span class=\"s1\">    <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>html += notification.title </span>\n<span class=\"s1\">    <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>html += \"&lt;/a&gt; from \" + notification.author + \"&lt;/p&gt;\"</span>\n<span class=\"s1\">    html += \"&lt;/body&gt;&lt;/html&gt;\"</span>\n<span class=\"s1\">    part1 = MIMEText(html, \"html\")</span>\n<span class=\"s1\">    message.attach(part1)</span>\n   <span class=\"s1\"> with smtplib.SMTP(\"localhost\", 25) as server:</span>\n<span class=\"s1\"> <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>server.sendmail(</span>\n<span class=\"s1\"> <span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>sender_email, receiver_email, message.as_string()</span>\n<span class=\"s1\"> <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>)</span></pre><p>Be aware that whitespace in Python is significant and simple copy-pasting may not work.&nbsp; You may need to replace the spaces at beginnings of lines with appropriate TAB characters.</p><p>Save this in a file like /usr/local/bin/let_offer_monitor.py .&nbsp; Make sure it\u2019s executable:</p><pre>chmod 755 /usr/local/bin/let_offer_monitor.py</pre><p>Then add a cron job to run it every 15 minutes or however often you like and you should start getting emails.&nbsp; The first email will have everything in the RSS cache but subsequent emails will only show new offers.</p><h1>How It Works</h1><p>The script creates a dot file in your home directory called .let_offers.&nbsp; This is a cache of links it\u2019s seen.</p><p>Then when it runs, it loads those links into the offers_seen list.&nbsp; It uses the feedparser module to read LET\u2019s RSS feed for the \u201coffers\u201d category and checks each one to see if it\u2019s in the existing cache.&nbsp; If it is not, it adds it to a \u2018notifications\u2019 list (this is so we can send one email instead of one email per new offer).</p><p>When it\u2019s done examining the RSS feed, if there are notifications to send, it builds an HTML email and send them to you with the title and author.&nbsp; The title is linked so you can just click on it.&nbsp; Here is an example:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4MDAiIGhlaWdodD0iMzcwIiB2aWV3Qm94PSIwIDAgODAwIDM3MCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-24329\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/07/let_offers.png.webp\" alt=\"\" width=\"800\" height=\"370\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/07/let_offers.png.webp 800w, https://lowendbox.com/wp-content/uploads/2020/07/let_offers-300x139.png.webp 300w, https://lowendbox.com/wp-content/uploads/2020/07/let_offers-768x355.png.webp 768w\" data-sizes=\"(max-width: 800px) 100vw, 800px\"></p><h1>Modifying the Script</h1><p>I took the code for sending email from <a href=\"https://realpython.com/python-send-email/#sending-your-plain-text-email\">this page on realpython.com</a>.&nbsp; If you need to use SSL, connect to a different port, or use a password to send email, you can easily replace my simplified code with the more full example there.</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><p>&nbsp;</p><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendlols-lowendtalk-moderators/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndLOLs: LowEndTalk Moderators\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/08/Comic-6-What-We-Do-800-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndLOLs: LowEndTalk Moderators</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/provider-911-black-friday-on-lowendbox-lowendtalk/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Provider 911: Black Friday on LowEndBox/LowEndTalk\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/10/Provider-911-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Provider 911: Black Friday on LowEndBox/LowEndTalk</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/new-benchmarking-series-on-lowendtalk/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"New Benchmarking Series on LowEndTalk\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/leb-centered-small.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">New Benchmarking Series on LowEndTalk</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/poll-why-do-you-visit-lowendtalk/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Poll: Why do you visit LowEndTalk?\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/06/lowendbox-poll-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Poll: Why do you visit LowEndTalk?</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}