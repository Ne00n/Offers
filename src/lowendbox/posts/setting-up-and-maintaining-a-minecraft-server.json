{"id": "23161", "post": "<div class=\"post-23161 post type-post status-publish format-standard hentry category-tutorials tag-how-to-setup-and-maintain-a-minecraft-server tag-minecraft tag-tutorial\" id=\"post-23161\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/setting-up-and-maintaining-a-minecraft-server/\" rel=\"bookmark\">Setting Up and Maintaining a Minecraft Server</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/how-to-setup-and-maintain-a-minecraft-server/\" rel=\"tag\">how to setup and maintain a minecraft server</a>, <a href=\"https://lowendbox.com/tag/minecraft/\" rel=\"tag\">minecraft</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> January 13, 2021 @ 6:14 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a target=\"_blank\" rel=\"noopener noreferrer\"><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2020/05/setting-up-minecraft-server.jpg.webp\" loading=\"lazy\" class=\"screenshot litespeed-loaded\" title=\"How to setup and maintain a Minecraft Server\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/05/setting-up-minecraft-server.jpg.webp\" alt=\"How to setup and maintain a Minecraft Server\" width=\"416\" height=\"241\" data-was-processed=\"true\"></a>In this tutorial, we\u2019ll show you how to setup a Minecraft game server on a Debian 10 VPS. But we won\u2019t stop at just starting the server but also will cover</p><ul><li>setting it up in systemd so it automatically starts/stops with the VPS boot</li><li>securing your Minecraft server with whitelisting</li><li>maintaining logs</li><li>backing up your Minecraft server so you can roll back to earlier versions</li></ul><p><span id=\"more-23161\"></span></p><h1>Prepping the Server</h1><p>I\u2019m using a fresh Debian 10 server with 2GB of RAM. As info, I\u2019ve run an identically sized Minecraft server (with Minecraft capped at 1GB of RAM) for 3-4 simultaneous players and have never had an issue. If you expect to host more players than that, you may want more RAM.</p><p>After imaging the VPS, install the Java Runtime Environment required to run Minecraft, as well as wget on the off change your particular Debian setup doesn\u2019t come with it:</p><pre>apt-get update\napt-get -y install openjdk-11-jre-headless wget</pre><p>There is no reason to run the Minecraft server as root, so we\u2019ll create an unprivileged users called (cleverly) \u201cminecraft\u201d:</p><pre>useradd -m -s /bin/bash minecraft &amp;&amp; passwd minecraft</pre><p>I\u2019m going to setup things in /minecraft, so create that directory and make it owned by user minecraft.&nbsp; Then we\u2019ll swich to the minecraft account:</p><pre>mkdir /minecraft\nchown minecraft:minecraft /minecraft\nsu - minecraft</pre><h1>Downloading the Minecraft Software</h1><p>Visit the Minecraft server page and you should see a page like the one shown below. Make note of hte \u201cDownload minecraft_server_VERSION.jar\u201d link and copy it. Because the server is periodically uploaded, you\u2019ll need to copy the link from this page rather than copying it from this tutorial.</p><p>Now execute:</p><pre>cd /minecraft\nwget the_url_you_copied_goes_here</pre><p>Let\u2019s tell the server we read the EULA so it doesn\u2019t ask us:</p><pre>echo \"eula=TRUE\" &gt; /minecraft/eula.txt</pre><p>Now we\u2019ll create a couple start/stop scripts. Put hte following in /minecraft/server_start.sh:</p><pre>#!/bin/bash \ncd /minecraft\n/usr/bin/java -Xms512M -Xmx1024M -jar server.jar nogui</pre><p>Note the -Xms and X-mx parameters. Those are \u201cminimum RAM for Java\u201d and \u201cmaximum RAM for Java\u201d. In this case, we\u2019re saying \u201cyou get a minimum of 512MB and a maximum of 1024MB\u201d. You should adjust these for your particular environment and needs.</p><p>Place the following in server_stop.sh:</p><pre>#!/bin/bash\nkill $(cat /minecraft/server.pid)</pre><p>That command simply says \u201ckill the process ID that the minecraft recorded as its process ID\u201d.</p><p>Make both scripts executable:</p><pre>chmod 755 /minecraft/start_server.sh\nchmod 755 /minecraft/stop_server.sh</pre><p>Then type \u201cexit\u201d to get out of your su session and go back to root.</p><p>Put the following in /lib/systemd/system/minecraft.service:</p><pre>[Unit]\nDescription=Minecraft Server\nAfter=network.target\n\n[Service]\nExecStart=/minecraft/server_start.sh\nExecStop=/minecraft/server_stop.sh\nRestart=always\nPIDFile=/minecraft/server.pid\nTimeoutStartSec=30\nUser=minecraft\nGroup=minecraft\n\n[Install]\nWantedBy=multi-user.target</pre><p>Now start the Minecraft server:</p><pre>systemctl daemon-reload\nsystemctl start minecraft</pre><p>Take a look in /minecraft/logs/latest.log and you\u2019ll see the server starting up:</p><pre>[09:43:34] [main/ERROR]: Failed to load properties from file: server.properties\n[09:43:41] [main/WARN]: Ambiguity between arguments [teleport, destination] and [teleport, targets] with inputs: [Player, 0123, @e, dd12be42-52a9-4a91-a8a1-11c01849e498]\n[09:43:41] [main/WARN]: Ambiguity between arguments [teleport, location] and [teleport, destination] with inputs: [0.1 -0.5 .9, 0 0 0]\n[09:43:41] [main/WARN]: Ambiguity between arguments [teleport, location] and [teleport, targets] with inputs: [0.1 -0.5 .9, 0 0 0]\n[09:43:41] [main/WARN]: Ambiguity between arguments [teleport, targets] and [teleport, destination] with inputs: [Player, 0123, dd12be42-52a9-4a91-a8a1-11c01849e498]\n[09:43:41] [main/WARN]: Ambiguity between arguments [teleport, targets, location] and [teleport, targets, destination] with inputs: [0.1 -0.5 .9, 0 0 0]\n[09:43:42] [Server thread/INFO]: Starting minecraft server version 1.15.2\n[09:43:42] [Server thread/INFO]: Loading properties\n[09:43:42] [Server thread/INFO]: Default game type: SURVIVAL\n[09:43:42] [Server thread/INFO]: Generating keypair\n[09:43:42] [Server thread/INFO]: Starting Minecraft server on *:25565\n[09:43:42] [Server thread/INFO]: Using epoll channel type\n[09:43:43] [Server thread/INFO]: Preparing level \"world\"\n[09:43:43] [Server thread/INFO]: Found new data pack vanilla, loading it automatically\n[09:43:43] [Server thread/INFO]: Reloading ResourceManager: Default\n[09:44:30] [Server thread/INFO]: Loaded 6 recipes\n[09:44:30] [Server thread/INFO]: Loaded 825 advancements\n[09:44:39] [Server thread/INFO]: Preparing start region for dimension minecraft:overworld\n[09:44:39] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:40] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:40] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:41] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:41] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:42] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:42] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:43] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:43] [Server-Worker-1/INFO]: Preparing spawn area: 0%\n[09:44:44] [Server-Worker-1/INFO]: Preparing spawn area: 1%\n[09:44:44] [Server-Worker-1/INFO]: Preparing spawn area: 1%\n[09:44:45] [Server-Worker-1/INFO]: Preparing spawn area: 1%\n[09:44:45] [Server-Worker-1/INFO]: Preparing spawn area: 2%\n[09:44:46] [Server-Worker-1/INFO]: Preparing spawn area: 3%\n&lt;lines trimmed&gt;\n[09:45:31] [Server-Worker-1/INFO]: Preparing spawn area: 96%\n[09:45:31] [Server-Worker-1/INFO]: Preparing spawn area: 98%\n[09:45:31] [Server thread/INFO]: Time elapsed: 52243 ms\n[09:45:31] [Server thread/INFO]: Done (108.563s)! For help, type \"help\"</pre><p>The \u201cERROR\u201d about no server.properties just means that no server.properties file existed. One is created automatically.</p><h2>Securing Minecraft</h2><p>To prevent any random Internet user from joining your Minecraft, you can setup a whitelist so that only people you designate are allowed to join.</p><p>First, edit your /minecraft/server.properties file and change this line to true:</p><pre>white-list=true</pre><p>Next, gather the username and UUID from the players you want to join. Players can find their UUIDs via this guide.<br>\nhttps://www.minecraftforum.net/forums/support/java-edition-support/2392452-finding-your-uuid-using-your-minecraft-client</p><p>Next, edit /minecraft/whitelist.json and include those you wish to allow. Here is an example:</p><pre>[\n  {\n    \"uuid\": \"852d0812-f394-4cb8-91f4-fa5161ab0f3b\",\n    \"name\": \"example1\"\n  },\n  {\n    \"uuid\": \"ff042255-2be5-41b6-8404-f1899e3dcef5\",\n    \"name\": \"example2\"\n  }\n]</pre><p>Now restart your Minecraft server:</p><pre>systemctl restart minecraft</pre><h1>Maintaining Logs</h1><p>The logs in /minecraft/logs will rotate automatically, so you don\u2019t need to manage that. Over 3 months, I find that logs are a few MB at most. However if you want to prune old logs, you can add a job line this in your crontab. In this example, all logs older than 30 days will be removed every night at 1am. The MAILTO directive will send all output (both stdout and stderr) to that email address.</p><pre>MAILTO=someone@who.cares\n0 1 * * * find /minecraft/logs -type f -mtime +30 -exec rm -f {} \\;</pre><h1>Backing Up Your Minecraft Server</h1><p>The script below will backup your Minecraft server so that if something bad happens, you can roll back to an earlier day simply by removing /minecraft and replacing it with the contents of a backup tarball.&nbsp; It works by stopping Minecraft, creating a compressed tar of the /minecraft directory, and then restarting Minecraft.</p><p>First, create a backup directory:</p><pre>mkdir /minecraft_backups\nchown minecraft:minecraft /minecraft_backups</pre><p>Then save this script as /minecraft_backups/backup_minecraft.sh. Update EMAIL to point to your email address and set DAYS_RETAIN to how many days back you want to save backups:</p><pre>#!/bin/bash\n\nEMAIL=someone@who.cares\nDAYS_RETAIN=30\n\nMINECRAFT_DIR=/minecraft\nBACKUP_DIR=/minecraft_backups\nLOG=\"/minecraft_backups/backup_minecraft.`date '+%Y%m%d'`.log\"\n\necho \"`date` starting\" &gt; $LOG\nsystemctl stop minecraft &gt;&gt; $LOG 2&gt;&amp;1\nrc=$?\necho \"`date` minecraft stop rc: $rc\" &gt;&gt; $LOG\nif [ $rc -ne 0 ] ; then\n  echo \"ERROR: could not stop minecraft!\" &gt;&gt; $LOG\n  mailx -s \"backup minecraft failed\" $EMAIL &lt; $LOG\n  exit 1\nfi\n\ntarfile=\"${BACKUP_DIR}/minecraft.`date '+%Y%m%d'`.tar.gz\"\necho \"`date` tarfile is $tarfile\" &gt;&gt; $LOG\ntar czf ${tarfile} ${MINECRAFT_DIR} &gt;&gt; $LOG 2&gt;&amp;1\nls -l ${tarfile} &gt;&gt; $LOG 2&gt;&amp;1\n\nsystemctl start minecraft &gt;&gt; $LOG 2&gt;&amp;1\nrc=$?\necho \"`date` minecraft start rc: $rc\" &gt;&gt; $LOG\nif [ $rc -ne 0 ] ; then\n  echo \"ERROR: could not start minecraft!\" &gt;&gt; $LOG\n  mailx -s \"backup minecraft failed\" $EMAIL &lt; $LOG\n  exit 1\nfi\n\necho \"`date` here are backup files to be removed:\" &gt;&gt; $LOG\nfind ${BACKUP_DIR} -mtime +${DAYS_RETAIN} -print &gt;&gt; $LOG 2&gt;&amp;1\necho \"`date` cleaning up files\" &gt;&gt; $LOG\nfind ${BACKUP_DIR} -mtime +${DAYS_RETAIN} -exec rm -f {} \\; &gt;&gt; $LOG 2&gt;&amp;1\necho \"`date` finished\" &gt;&gt; $LOG</pre><p>Make it executable:</p><pre>chmod 755 /minecraft_backups/backup_minecraft.sh</pre><p>Here is an example of the log output from a backup:</p><pre>$ cat /minecraft_backups/backup_minecraft.20200513.log \nWed 13 May 2020 02:00:01 AM PDT starting\nWed 13 May 2020 02:00:01 AM PDT minecraft stop rc: 0\nWed 13 May 2020 02:00:01 AM PDT tarfile is /minecraft_backups/minecraft.20200513.tar.gz\ntar: Removing leading `/' from member names\n-rw-r--r-- 1 root root 195796750 May 13 02:00 /minecraft_backups/minecraft.20200513.tar.gz\nWed 13 May 2020 02:00:08 AM PDT minecraft start rc: 0\nWed 13 May 2020 02:00:08 AM PDT here are files to be removed:\n-rw-r--r-- 1 root root 195796630 Apr 12 02:00 /minecraft_backups/minecraft.20200412.tar.gz\nWed 13 May 2020 02:00:08 AM PDT cleaning up files\nWed 13 May 2020 02:00:08 AM PDT finished</pre><p>To set this job to run automatically, put the following in your crontab.</p><pre>0 2 * * * /minecraft_backups/backup_minecraft.sh</pre><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/highly-available-wordpress-from-scratch-part-6/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Setup a Highly Available WordPress Site From Scratch, Part 6\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/05/highly-available-wordpress-part-6-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Setup a Highly Available WordPress Site From Scratch, Part 6</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/5-common-uses-for-a-lowendbox-cheap-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"5 Common Uses for a LowEndBox (Cheap VPS)\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/5-common-uses-for-lowendbox-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">5 Common Uses for a LowEndBox (Cheap VPS)</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-setup-a-highly-available-wordpress-site-from-scratch-part-5/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Setup a Highly Available WordPress Site From Scratch, Part 5\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/05/highly-available-wordpress-part5-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Setup a Highly Available WordPress Site From Scratch, Part 5</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-setup-a-highly-available-wordpress-from-scratch-part-4/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Setup a Highly Available WordPress Site From Scratch, Part 4\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/05/highly-available-wordpress-part-4-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Setup a Highly Available WordPress Site From Scratch, Part 4</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}