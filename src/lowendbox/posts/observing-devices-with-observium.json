{"id": "5037", "post": "<div class=\"post-5037 post type-post status-publish format-standard hentry category-tutorials tag-tutorials-2\" id=\"post-5037\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/observing-devices-with-observium/\" rel=\"bookmark\">Observing devices with Observium \u2013 Setting up the server</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/tutorials-2/\" rel=\"tag\">tutorials</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> March 29, 2014 @ 7:30 am, by Maarten Kossen</div><div class=\"storycontent tablelook\"><p><a href=\"https://lowendbox.com/blog/observing-devices-with-observium\"><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" loading=\"lazy\" class=\"alignnone size-full wp-image-3957 aligncenter litespeed-loaded\" alt=\"lowendtutorial\" data-src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" width=\"271\" height=\"70\" data-was-processed=\"true\"></a></p><p>It\u2019s time for another tutorial! This time I\u2019m taking you into the magical world of Observium and SNMP. Observium is a tool that helps you monitor your servers remotely. But not only your servers; all devices that support SNMP, so that includes most managed switches. It monitors network performance (it basically monitors all network ports), but also server performance (like CPU, I/O), server status (free disk space, memory status), and much more. It\u2019s really <em>the</em> tool out there to get statistics of your servers. Best of all: it\u2019s open source and it\u2019s free!</p><p>I\u2019m going to show you how to set up an Observium server. My next tutorial will cover adding devices. This one is going to be lengthy enough as it is and there\u2019s a lot to say about adding a device to Observium, so I will not overload you with too much information. I will show the setup procedure for Ubuntu, as that is where Observium is tested on. This tutorial should also work for Debian. RHEL/CentOS is not recommended for the server, but are fine to be used for devices that you monitor.</p><p>Let\u2019s get working!</p><p><span id=\"more-5037\"></span></p><h2>Server installation</h2><p>As I said before, Ubuntu is recommended for the server installation. Ubuntu 12.04 LTS works best for this, but 12.10 and 13.10 should work as well. 13.10 or higher <em>will</em> give you a lot of issues as they switched to Apache 2.4 and a lot of other packages changed as well, so using one of those version will probably leave you with a broken installation.</p><p>First, update the apt cache. On new installations a lot of packages may not be found because they haven\u2019t been cached yet.</p><blockquote><p>sudo apt-get update</p></blockquote><p>Second step is to install all required packages:</p><blockquote><p>sudo apt-get install libapache2-mod-php5 php5-cli php5-mysql php5-gd php5-snmp php-pear snmp graphviz php5-mcrypt php5-json mysql-server mysql-client rrdtool fping imagemagick whois mtr-tiny nmap ipmitool python-mysqldb</p></blockquote><p>This will install Apache, PHP, MySQL, and a lot of other tools needed for Observium to work. I\u2019ve removed subversion from the original package list, as it\u2019s only used for the Observium Subscription Edition. We\u2019re going to install the Community Edition. During installation, you are asked for a root password for MySQL (possibly multiple times). Pick a strong password for this and keep it somewhere safe, like in a KeePass database.</p><p>Observium needs a home, so create it:</p><blockquote><p>sudo mkdir -p /opt/observium &amp;&amp; cd /opt</p></blockquote><p>Download Observium:</p><blockquote><p>sudo wget http://www.observium.org/observium-community-latest.tar.gz</p></blockquote><p>And unpack it (it will automatically put it in the right directory):</p><blockquote><p>sudo tar zxvf observium-community-latest.tar.gz</p></blockquote><p>Head into the observium directory:</p><blockquote><p>cd observium</p></blockquote><p>And copy the default configuration file to an actual configuration file:</p><blockquote><p>sudo cp config.php.default config.php</p></blockquote><p>Next thing we\u2019ve got to do is set up the MySQL user for Observium and create a database that that user can access. So let\u2019s open up MySQL:</p><blockquote><p>mysql -u root -p</p></blockquote><p>This will prompt you for the root password you\u2019ve set before. Once filled in, you\u2019ll be in the MySQL command line client. First thing to do there, is create a database:</p><blockquote><p>CREATE DATABASE observium;</p></blockquote><p>Next, create a user and give it access to the database, all with one line:</p><blockquote><p>GRANT ALL PRIVILEGES ON observium.* TO \u2018observium\u2019@\u2019localhost\u2019 IDENTIFIED BY \u2018&lt;password&gt;\u2019;</p></blockquote><p>Again, pick a strong password here, and replace &lt;password&gt; with your password. Now, exit the MySQL client:</p><blockquote><p>exit</p></blockquote><p>And you\u2019re good to go edit the Observium configuration file. Open it up:</p><blockquote><p>sudo vim config.php</p></blockquote><p>And fill out the following config options:</p><blockquote><p>$config[\u2018db_user\u2019] = \u201cUSERNAME\u201d;<br>\n$config[\u2018db_pass\u2019] = \u201cPASSWORD\u201d;</p></blockquote><p>Replace USERNAME with \u2018observium\u2019 and PASSWORD with the password you have the observium database user. Save the file and exit vim.</p><p>Now we can set up Observium by running the following file. This will populate the database with the necessary tables.</p><blockquote><p>php includes/update/update.php</p></blockquote><p>This could give some errors up to revision 006, but I personally didn\u2019t get them.</p><p>Next, create a directory for RDD:</p><blockquote><p>sudo mkdir rrd</p></blockquote><p>And set the right permissions on it:</p><blockquote><p>sudo chown www-data:www-data rrd</p></blockquote><p>The \u2018rdd\u2019 folder is now owned by www-data. Apache runs the web server as that user, so the Apache process can now write to that directory. Observium writes .rrd files for each device to this directory. RDDTool is a data logging and graphing system, so it gets you all these fancy graphs.</p><p>Now we have to create the virtual host configuration for Observium. You can either add a new virtual host or alter the default one. I\u2019m going to alter the default one, as my server is only going to contain observium and nothing else. Open up the default virtual host file:</p><blockquote><p>sudo vim /etc/apache2/sites-available/default</p></blockquote><p>And make sure the contents match this:</p><blockquote><p>&lt;VirtualHost *:80&gt;<br>\nServerAdmin webmaster@localhost<br>\nDocumentRoot /opt/observium/html<br>\n&lt;Directory /&gt;<br>\nOptions FollowSymLinks<br>\nAllowOverride None<br>\n&lt;/Directory&gt;<br>\n&lt;Directory /opt/observium/html/&gt;<br>\nOptions Indexes FollowSymLinks MultiViews<br>\nAllowOverride All<br>\nOrder allow,deny<br>\nallow from all<br>\n&lt;/Directory&gt;<br>\nErrorLog&nbsp; ${APACHE_LOG_DIR}/error.log<br>\nLogLevel warn<br>\nCustomLog&nbsp; ${APACHE_LOG_DIR}/access.log combined<br>\nServerSignature On<br>\n&lt;/VirtualHost&gt;</p></blockquote><p>You may change the ServerAdmin e-mail address to one of your choosing, but it\u2019s not required. This e-mail address will be used on error pages, so make sure not to enter your super private e-mail address here. Save the file.</p><p>We now need to enable the Apache rewrite module, which allows Observium to rewrite URLs:</p><blockquote><p>sudo a2enmod rewrite</p></blockquote><p>And finally, restart Apache:</p><blockquote><p>sudo service apache2 restart</p></blockquote><p>And you\u2019re good! Observium is now running. It\u2019s not doing much yet and you can\u2019t log in, but it works. Visit the IP address of your server or the domain name you pointed there and you should see the Observium login screen. Let\u2019s configure observium (don\u2019t worry, this is just a few steps).</p><h2>Configuring Observium</h2><p>Make sure you are in the observium directory:</p><blockquote><p>cd /opt/observium</p></blockquote><p>And run the following script:</p><blockquote><p>./adduser.php &lt;username&gt; &lt;password&gt; &lt;level&gt;</p></blockquote><p>Replace &lt;username&gt; with a username you would like to use, &lt;password&gt; with a strong password, and &lt;level&gt; with 10. Level 10 means you have all access (it\u2019s the \u2018admin\u2019 level). So, a filled out command should look like:</p><blockquote><p>./adduser.php mpkossen AStrongPassword 10</p></blockquote><p>The user should now be added and you should be able to log in to Observium.</p><p>Finally, we should set up some cron jobs that Observium needs. Open up the generic cron tab:</p><blockquote><p>sudo vim /etc/crontab</p></blockquote><p>And add the following lines:</p><blockquote><p>33&nbsp; */6&nbsp;&nbsp; * * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; /opt/observium/discovery.php -h all &gt;&gt; /dev/null 2&gt;&amp;1<br>\n*/5 *&nbsp;&nbsp;&nbsp;&nbsp; * * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; /opt/observium/discovery.php -h new &gt;&gt; /dev/null 2&gt;&amp;1<br>\n*/5 *&nbsp;&nbsp;&nbsp;&nbsp; * * *&nbsp;&nbsp; root&nbsp;&nbsp;&nbsp; /opt/observium/poller-wrapper.py 1 &gt;&gt; /dev/null 2&gt;&amp;1</p></blockquote><p>You should <em>not</em> place this in a user\u2019s crontab, as it includes a username. So don\u2019t use \u2018crontab -e\u2019 or something.</p><p>These three cron jobs are for discovering devices (new and existing) and one that polls them for data, which is basically the most essential part of Observium.</p><p>Once this is done, you are all set! Observium is up and running and you\u2019re ready to add devices!</p><h2>Final notes</h2><p>This installation is a bit of a lengthy process by the looks of it. If you\u2019ve done it before, though, you know what to do at each step and it\u2019ll go pretty fast. Of course, you probably only ever need one Observium server, so that\u2019s a moot point.</p><p>Next week, I\u2019m going to show you how to add devices to your Observium installation. You could also have a go and figure it out yourself, of course. Or, if you want something else to do, try to secure the Observium server with an SSL connection so not all data you\u2019re looking at goes over the internet as plain text.</p><p><span style=\"text-decoration: underline;\">Up next week</span>: Observing devices with Observium \u2013 Adding a device</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fobserving-devices-with-observium%2F&amp;t=Observing%20devices%20with%20Observium%20-%20Setting%20up%20the%20server\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Observing%20devices%20with%20Observium%20-%20Setting%20up%20the%20server&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fobserving-devices-with-observium%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fobserving-devices-with-observium%2F&amp;title=Observing%20devices%20with%20Observium%20-%20Setting%20up%20the%20server&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/centos-6-end-of-life-is-coming-upgrade-to-a-new-centos-7-vps-now/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"CentOS 6 End of Life is Coming! Upgrade to a new CentOS 7 VPS Now\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/centos-6-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">CentOS 6 End of Life is Coming! Upgrade to a new CentOS 7 VPS Now</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/best-web-hosting-control-panels-after-the-cpanel-price-hike/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Best Web Hosting Control Panels after the cPanel Price Hike\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Best Web Hosting Control Panels after the cPanel Price Hike</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-set-up-plex-media-server-on-your-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Set Up Plex Media Server on Your Cheap VPS\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/how-to-set-up-plex-media-server-on-vps-2-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Set Up Plex Media Server on Your Cheap VPS</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-create-a-dns-server-on-debian-stretch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How To Create a DNS Server On Debian Stretch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/leb-centered-small.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How To Create a DNS Server On Debian Stretch</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/mpkossen/\" title=\"All posts by Maarten Kossen\" rel=\"author\">Maarten Kossen</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">Maarten Kossen was the administrator of LowEndBox from 2013 to 2015, and brought many ideas and improvements to the website during his leadership. Today he is member of our community and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}