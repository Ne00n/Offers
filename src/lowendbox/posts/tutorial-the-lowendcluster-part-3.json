{"id": "6924", "post": "<div class=\"post-6924 post type-post status-publish format-standard hentry category-tutorials tag-tutorial\" id=\"post-6924\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/tutorial-the-lowendcluster-part-3/\" rel=\"bookmark\">Tutorial \u2013 The LowEndCluster \u2013 Part 3</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> May 12, 2015 @ 1:00 pm, by Maarten Kossen</div><div class=\"storycontent tablelook\"><p style=\"text-align: center;\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzEiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCAyNzEgNzAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNjZmQ0ZGIiLz48L3N2Zz4=\" loading=\"lazy\" class=\"alignnone size-full wp-image-3957\" data-src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" alt=\"lowendtutorial\" width=\"271\" height=\"70\"></p><p>Welcome back to the 3rd part of the LowEndCluster tutorial series! Last time we\u2019ve set up an actual web node which we\u2019re going to put behind a \u201cload balancer\u201d, or actually a proxy, in this tutorial. The result will be that it\u2019s both available over IPv4 and IPv6.</p><p>Before we dive into this neat function of NGINX however, let me get back to the LowEndCluster as a whole. Initially, I had two goals in mind: redundancy <em>and</em> scalability. While working on the cluster, I found out that doing both at the same time provides a lot of challenges, some even at the budget-part. My goal was to have a redundant cluster for less than $50/year and I\u2019m going to retain my focus on that. Automatic fail-over and scaling is something I\u2019d like to cover in future tutorials, but not in this series. This means that our filesystem doesn\u2019t <em>technically</em> require KVM machines anymore. I\u2019ll do a wrap-up in the end of what I turned out to be using for this tutorial so you have a nice overview.</p><p>Anyway, enough babbling. Let\u2019s get to work!</p><p><span id=\"more-6924\"></span></p><p>This time the tutorial is probably even easier than it was the last time, or the time before that. Creating a proxy with NGINX is actually very easy and you only need to do it once and then copy the contents over to your backup server.</p><p>I\u2019m still assuming a Debian-based distribution, but since this is NGINX configuration this should work on any OS which has NGINX installed.</p><p>First, let\u2019s install NGINX:</p><blockquote><p>sudo apt-get install nginx</p></blockquote><p>Once that\u2019s finished, go to the directory with the site configuration files: /etc/nginx/sites-available. In that directory, create a file named \u2018YOURDOMAIN.conf\u2019, so for example: example.net.conf.</p><p>In that file (/etc/nginx/sites-available/example.net.conf) past the following content:</p><blockquote><p>server {<br>\nlisten 80;<br>\nlisten [::]:80;</p><p>server_name example.net;</p><p>location / {<br>\nproxy_pass http://wordpress.example.net/;<br>\n}<br>\n}</p></blockquote><p>Now, first of all, what we did here is create a \u2018server\u2019 object that tells NGINX a server definition is contained inside it.</p><p>The first two lines inside that object:</p><blockquote><p>listen 80;<br>\nlisten [::]:80;</p></blockquote><p>Tell NGINX to listen on port 80 over IPv4 (first line) and on port 80 over IPv6 (second line). Naturally, if you\u2019d wanted to change the ports, this is where you\u2019d do it. I\u2019m assuming you don\u2019t, as that would kind of ruin this whole plan.</p><blockquote><p>server_name example.net;</p></blockquote><p>Put the server name you want NGINX to listen for on this line. You can add multiple like this:</p><blockquote><p>server_name example.net example.com example.org;</p></blockquote><p>Because we\u2019re not pinning this server to specific IP addresses, be sure to include any subdomains you want NGINX to listen for as well.</p><p>This address will also be the address of your WordPress installation. I recommended last time that you\u2019d use your eventual WordPress domain temporarily for your web node; this is the time to configure that here.</p><p>Now, on to the last block:</p><blockquote><p>location / {<br>\nproxy_pass http://wordpress.example.net/;<br>\n}</p></blockquote><p>Here we tell NGINX to pass all requests coming to this server to your WordPress web node. I\u2019ve used an example domain here, but I\u2019d recommend you to pick another domain name for your web nodes (give a different one to each) and configure your primary one here. If that is down, you can easily switch to the other domain and continue serving from that.</p><p>With the configuration file all finished, let\u2019s enable it so NGINX knows it needs to load this file:</p><blockquote><p>ln -s /etc/nginx/sites-available/example.net.conf /etc/nginx/sites-enabled/example.net.conf</p></blockquote><p>And finally, restart NGINX:</p><blockquote><p>sudo service nginx restart</p></blockquote><p>And you\u2019re done! If you\u2019ve done all right, you should now be able to go to example.net and find it\u2019s serving your WordPress installation from your web nodes, using an external database server!</p><p>Now, in order to make this redundant (or easy to fix in case it goes down), copy over the above</p><hr><p>That\u2019s it for this week, short and sweet. There\u2019s more cool things you could do with both NGINX and the cluster. For example, you could have NGINX load balance between multiple web nodes very easily. While in this setup that could put some strain on the database server (and eventually the file system), in another setup it could be really useful.</p><p>With the current LowEndSpirit pricing, you could even copy this setup to multiple locations and see if you can start serving your visitors from the server closest to them (albeit with a few challenges).</p><p>Next time, it\u2019s filesystem time and we\u2019re going to make that last part redundant as well!</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Ftutorial-the-lowendcluster-part-3%2F&amp;t=Tutorial%20%E2%80%93%20The%20LowEndCluster%20%E2%80%93%20Part%203\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Tutorial%20%E2%80%93%20The%20LowEndCluster%20%E2%80%93%20Part%203&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Ftutorial-the-lowendcluster-part-3%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Ftutorial-the-lowendcluster-part-3%2F&amp;title=Tutorial%20%E2%80%93%20The%20LowEndCluster%20%E2%80%93%20Part%203&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Keeping A (log)Watchful Eye on Your VPS With logwatch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/logwatch-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Keeping A (log)Watchful Eye on Your VPS With logwatch</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/mpkossen/\" title=\"All posts by Maarten Kossen\" rel=\"author\">Maarten Kossen</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">Maarten Kossen was the administrator of LowEndBox from 2013 to 2015, and brought many ideas and improvements to the website during his leadership. Today he is member of our community and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}