{"id": "22421", "post": "<div class=\"post-22421 post type-post status-publish format-standard hentry category-tutorials tag-logging tag-logwatchful tag-monitoring tag-tutorial\" id=\"post-22421\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\" rel=\"bookmark\">Keeping A (log)Watchful Eye on Your VPS With logwatch</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/logging/\" rel=\"tag\">logging</a>, <a href=\"https://lowendbox.com/tag/logwatchful/\" rel=\"tag\">logwatchful</a>, <a href=\"https://lowendbox.com/tag/monitoring/\" rel=\"tag\">monitoring</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> October 27, 2020 @ 1:00 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MTYiIGhlaWdodD0iMjQ1IiB2aWV3Qm94PSIwIDAgNDE2IDI0NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"screenshot\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/04/logwatch.png.webp\" alt=\"\" width=\"416\" height=\"245\"></a></p><p class=\"p1\"><span class=\"s1\">Your logs are an invaluable source of information about what\u2019s going on inside your system and can alert you to security issues, service issues, and hardware problems.&nbsp; </span><span class=\"s1\"><span class=\"Apple-converted-space\">But you are only aware of what they\u2019re trying to tell you if you actually read them.&nbsp; It would be a burdensome chore to login to each system every day and manually view the logs.&nbsp; Fortunately, you can automate this task with the logwatch tool, which is a </span></span><span class=\"s1\">customizable, pluggable log monitoring system.</span></p><p>Read more to continue\u2026</p><p><span id=\"more-22421\"></span></p><p class=\"p1\"><span class=\"s1\">To install logwatch on Debian-based systems:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>apt-get install logwatch</span></pre><p class=\"p1\"><span class=\"s1\">On CentOS-based systems:</span></p><pre class=\"p1\"><span class=\"s1\"> <span class=\"Apple-converted-space\">&nbsp; </span>yum -y install logwatch </span></pre><p class=\"p1\"><span class=\"s1\">Just running logwatch out of the box gives us some great info:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>$ logwatch</span>\n<span class=\"s1\"> ################### Logwatch 7.4.0 (03/01/11) #################### </span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Processing Initiated: Tue Apr<span class=\"Apple-converted-space\">&nbsp; </span>7 22:30:28 2020</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Date Range Processed: yesterday</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>( 2020-Apr-06 )</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span>Period is day.</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Detail Level of Output: 0</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Type of Output/Format: stdout / text</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>Logfiles for Host: myserver.example.com</span>\n<span class=\"s1\"> ################################################################## </span>\n<span class=\"s1\"> --------------------- SSHD Begin ------------------------ </span>\n<span class=\"s1\"> Illegal users from:</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>undef: 62 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>51.91.140.218: 5 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>76.72.169.18 (egh4.com): 3 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>88.146.200.8: 6 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.7: 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.104: 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.105: 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.106: 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.107: 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>92.63.194.108: 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>93.174.93.10 (storedatatips.com): 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>93.235.99.248 (p5DEB63F8.dip0.t-ipconnect.de): 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>144.217.207.15 (ip15.ip-144-217-207.net): 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>176.37.60.16 (host-176-37-60-16.la.net.ua): 2 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>177.161.47.151 (177-161-47-151.user.vivozap.com.br): 35 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>179.106.64.134 (179-106-64-134.hnnet.com.br): 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>185.234.218.68: 1 time</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>193.142.146.21: 64 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>195.231.8.141 (host141-8-231-195.serverdedicati.aruba.it): 4 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>203.185.4.41 (mail.belfry.com.hk): 13 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>205.185.120.163 (.): 5 times</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>212.85.80.247 (h-80-247.A165.priv.bahnhof.se): 2 times\n</span>\n<span class=\"s1\"> Received disconnect:</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>11: Bye Bye [preauth] : 435 Time(s)</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>11: Normal Shutdown, Thank you for playing [preauth] : 22 Time(s)</span>\n<span class=\"s1\"> ---------------------- SSHD End ------------------------- \n</span>\n<span class=\"s1\"> --------------------- Disk Space Begin ------------------------ </span>\n<span class=\"s1\"> Filesystem<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; </span>Size<span class=\"Apple-converted-space\">&nbsp; </span>Used Avail Use% Mounted on</span>\n<span class=\"s1\"> devtmpfs<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>486M <span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>0<span class=\"Apple-converted-space\">&nbsp; </span>486M <span class=\"Apple-converted-space\">&nbsp; </span>0% /dev</span>\n<span class=\"s1\"> /dev/vda1<span class=\"Apple-converted-space\">&nbsp; &nbsp; &nbsp; &nbsp; </span>25G<span class=\"Apple-converted-space\">&nbsp; </span>1.6G <span class=\"Apple-converted-space\">&nbsp; </span>22G <span class=\"Apple-converted-space\">&nbsp; </span>7% /</span>\n<span class=\"s1\"> ---------------------- Disk Space End ------------------------- </span>\n\n<span class=\"s1\"> ###################### Logwatch End ######################### </span></pre><p class=\"p1\"><span class=\"s1\">Here we can see numerous attempted logins (probably because ssh was still running on port 22) as well as the status of our disk space.<span class=\"Apple-converted-space\">&nbsp; </span>This is an example of detail on the \u2018Low\u2019 setting.<span class=\"Apple-converted-space\">&nbsp; </span>If we turned on the \u2018High\u2019 output of detail, we\u2019d be able to see exactly which user tried to login.</span></p><p class=\"p1\"><span class=\"s1\">One of the nice things about logwatch is that as you add services (email, httpd, etc.) logwatch will detect this and add sections to your reports with pertinent information.</span></p><p class=\"p1\"><span class=\"s1\">It\u2019s easy to configure logwatch to mail reports to you daily, which allows a quick review.</span></p><p class=\"p1\"><span class=\"s1\">Modify /etc/logwatch/conf/logwatch.conf and add the following line:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>MailTo = &lt;your email&gt;</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>Output = email</span>\n<span class=\"s1\">&nbsp; &nbsp; Detail = High</span></pre><p class=\"p1\"><span class=\"s1\">By default, both Debian and CentOS create cron jobs to run logwatch nightly (in /etc/cron.daily) so you should begin receiving reports nightly.</span></p><p>&nbsp;</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fkeeping-a-logwatchful-eye-on-your-vps-with-logwatch%2F&amp;t=Keeping%20A%20%28log%29Watchful%20Eye%20on%20Your%20VPS%20With%20logwatch\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Keeping%20A%20%28log%29Watchful%20Eye%20on%20Your%20VPS%20With%20logwatch&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fkeeping-a-logwatchful-eye-on-your-vps-with-logwatch%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fkeeping-a-logwatchful-eye-on-your-vps-with-logwatch%2F&amp;title=Keeping%20A%20%28log%29Watchful%20Eye%20on%20Your%20VPS%20With%20logwatch&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">4</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/top-ten-things-that-should-be-in-your-dot-files/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Top Ten Things That Should Be In Your Dot Files\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Top Ten Things That Should Be In Your Dot Files</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}