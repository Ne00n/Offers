{"id": "26332", "post": "<div class=\"post-26332 post type-post status-publish format-standard hentry category-editorial tag-debian tag-linux tag-security tag-vulnerability\" id=\"post-26332\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/vulnerability-in-debian-10-solusvm-templates-you-need-to-take-action/\" rel=\"bookmark\">Vulnerability in Debian 10 SolusVM Templates \u2013 You Need to Take Action</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/debian/\" rel=\"tag\">debian</a>, <a href=\"https://lowendbox.com/tag/linux/\" rel=\"tag\">linux</a>, <a href=\"https://lowendbox.com/tag/security/\" rel=\"tag\">Security</a>, <a href=\"https://lowendbox.com/tag/vulnerability/\" rel=\"tag\">vulnerability</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> February 3, 2021 @ 4:51 pm, by raindog308</div><div class=\"storycontent tablelook\"><p>SolusVM is a popular virtualization management solution used by many VPS providers.&nbsp; It\u2019s a familiar control panel for end users, who use it to setup their VPSes.&nbsp; Most providers offer templates, which are pre-configured Linux systems based on the most common distros \u2013 CentOS, Debian, Ubuntu, Arch, etc.</p><p>These templates are provided by SolusVM.&nbsp; Unfortunately, one of the most popular template (Debian 10) has been found to have a serious security vulnerability.&nbsp; <strong>If you setup your VPS using the Debian 10 template, you need to take action.</strong></p><h3>What\u2019s the Issue?</h3><p>The SolusVM-provided Debian 10 template contains a user called \u201cdebianuser\u201d.&nbsp; This user may still exist after setup, in which an outsider could potentially access your VM.</p><h3>Am I Vulnerable?</h3><p>You may be if both these things are true:</p><ul><li>You installed Debian 10</li><li>You installed it from a SolusVM-provided template</li></ul><p>Contact your provider and ask about your situation.&nbsp; Several prominent providers have already sent out warning emails.</p><p><span id=\"more-26332\"></span></p><h3>Any Other Details?</h3><p>It appears that a hacker would need to authenticate as debianuser using a password.&nbsp; If you have disabled password authentication (i.e., you\u2019re only allowing ssh key authentication) you&nbsp;<em>should</em> be safe.&nbsp; But it\u2019s something you would have had to do very soon after install, otherwise you don\u2019t know what happened before you made that change.</p><h3>How Do I Fix This?</h3><p>Unfortunately, the only way to truly fix it is to reinstall your VPS.</p><h3>I Installed Debian 10 From ISO \u2013 Am I Vulnerable?</h3><p>No.</p><h3>What Are Signs of Compromise?</h3><p>This vulnerability has been associated with the CrytoNight miner.&nbsp; If you see a process called \u2018cnrig\u2019 on your system, you have definitely been compromised.&nbsp; However, it\u2019s worth pointing out that a sophisticated hacker could replace the tools you use (ps, grep, etc.) to see if that process is running with compromised versions that don\u2019t allow you to see it.</p><p>You can also see if the debianuser user account exists:</p><pre class=\"p1\"><span class=\"s1\"># grep debianuser /etc/passwd</span>\n<span class=\"s1\">debianuser:x:1000:1000:DebianUser,,,:/home/debianuser:/bin/bash</span>\n\n</pre><h3>I\u2019m Too Busy Getting Ready to Play in the SuperBowl to Reinstall Right Now \u2013 Anything I Can in the Meantime?</h3><p>You can delete the debianuser account (userdel debianuser) and turn off password authentication (start <a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-1/\" target=\"_blank\" rel=\"noopener\">here</a>).&nbsp; Also, if you see any process called \u2018cnrig\u2019 you should kill it.</p><p>But to emphasize: once a hacker\u2019s been on your box, you have no way of knowing what he\u2019s done or what the state of your system is.</p><h3>Can\u2019t I Just Install a Patch?</h3><p>Unlike a software vulnerability, this is more of an administrative vulnerability.&nbsp; There is nothing wrong with the software on your system.&nbsp; SolusVM just forgot to delete an account.&nbsp; This can\u2019t be patched away.</p><p>Your provider&nbsp;<em>should</em> replace their template, but that will only help future installs.</p><h3>How Long Has This Exploit Been in the Wild?</h3><p>At least since October 2020, if not earlier.</p><h3>Where Can I Learn More?</h3><p>You can read the relevant thread on <a href=\"https://www.lowendtalk.com/discussion/169685/vulnerability-in-solusvm-debian-10-template-debianuser-backdoor-default-user\" target=\"_blank\" rel=\"noopener\">LowEndTalk</a></p><p>&nbsp;</p><p>&nbsp;</p><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/getting-nerdy-with-your-passwords-the-bitwarden-command-line-interface/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Getting Nerdy With Your Passwords: the Bitwarden Command Line Interface\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/leb-centered-small.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Getting Nerdy With Your Passwords: the Bitwarden Command Line Interface</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/take-control-of-your-passwords-with-self-hosted-bitwarden/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Take Control of Your Passwords with Self-Hosted Bitwarden\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/06/bitwarden1-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Take Control of Your Passwords with Self-Hosted Bitwarden</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/artichost-has-some-professional-grade-vpses-at-great-prices-chicago-windows-of-linux-starting-at-3-99-mo/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"ArticHost has Some Professional-Grade VPSes at Great Prices! (Chicago Windows of Linux Starting at $...\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/01/arctichost-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">ArticHost has Some Professional-Grade VPSes at Great Prices! (Chicago Windows of Linux Starting at $...</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/huge-sudo-security-issue-update-your-systems-now/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Huge sudo Security Issue - Update Your Systems Now!\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/01/sandwich-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Huge sudo Security Issue - Update Your Systems Now!</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}