{"id": "24095", "post": "<div class=\"post-24095 post type-post status-publish format-standard hentry category-tutorials tag-cloud tag-dropbox tag-linux tag-storage\" id=\"post-24095\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/one-folder-to-rule-them-all-running-dropbox-headless-on-your-vps/\" rel=\"bookmark\">One Folder to Rule Them All: Running Dropbox Headless on Your VPS</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" width=\"16\" height=\"16\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/cloud/\" rel=\"tag\">cloud</a>, <a href=\"https://lowendbox.com/tag/dropbox/\" rel=\"tag\">dropbox</a>, <a href=\"https://lowendbox.com/tag/linux/\" rel=\"tag\">linux</a>, <a href=\"https://lowendbox.com/tag/storage/\" rel=\"tag\">storage</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" width=\"16\" height=\"16\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> July 8, 2021 @ 6:28 pm, by raindog308</div><div class=\"storycontent tablelook\"><p><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2021/07/dropbox_logo.png\" loading=\"lazy\" class=\"alignright size-full wp-image-27756 litespeed-loaded\" data-src=\"https://lowendbox.com/wp-content/uploads/2021/07/dropbox_logo.png\" alt=\"Dropbox\" width=\"300\" height=\"292\" align=\"right\" hspace=\"20\" data-was-processed=\"true\">Dropbox is a folder synchronization product that takes a folder (eponymously called Dropbox) and makes sure it\u2019s identical across all devices.&nbsp; This folder is also available on the web and there are robust sharing options.&nbsp; Dropbox was one of the first in this space, before Google Drive and Microsoft\u2019s OneDrive.&nbsp; They support all major operating systems including Linux, and also offer a headless client.&nbsp; In this tutorial, we\u2019ll look at running Dropbox headless on your Linux VPS.</p><h1>Why Use Dropbox on a VPS?</h1><p>While most people use Dropbox to synchronize their personal files, documents, and media, as well as back them up to the cloud, there are ways to exploit Dropbox\u2019s abilities on your VPS.</p><ul><li>Backups are as simple as creating files in ~/Dropbox</li><li>File distribution is dead simple when you have a directory that is identical everywhere</li><li>You can have a job that watches for files in certain folders and handles them, whether it be as jobs to be executed, media to be processed, etc.</li><li>Any media or data that originates in the cloud can easily and automatically be transported home</li></ul><h1>Preparing for Install</h1><p>First, if you haven\u2019t done so, you\u2019ll need to sign up on Dropbox.com.&nbsp; Accounts are <a href=\"https://www.dropbox.com/basic\" aria-label=\"Dropbox\">free with a small quota</a>, and of course if you choose you can <a href=\"https://www.dropbox.com/buy\" aria-label=\"Dropbox\">buy more storage</a>.</p><p>You\u2019ll need some prerequisites before you can install Dropbox.&nbsp; On a Debian 10 system, these can be satisfied with a single command:</p><pre>apt install libglib2.0 libxdamage1 libglapi-mesa libxcb-glx0 libxcb-dri2-0 libxcb-dri3-0 libxcb-present0 libxcb-sync1 libxshmfence1 libxxf86vm1</pre><p>Next, you\u2019ll need to increase the number of inotify watches.&nbsp; Dropbox is constantly monitoring in the background for new files, deleted files, changed directories, etc. so it needs to have many watches.&nbsp; You can setup more watches like this:</p><pre>echo fs.inotify.max_user_watches=100000 &gt;&gt; /etc/sysctl.conf\nsysctl -p</pre><h1>Installing the Dropbox Daemon</h1><p>There are two things you\u2019ll need:</p><ul><li>The dropboxd daemon</li><li>dropbox.py, a command-line interface program</li></ul><p>Start by downloading the daemon.&nbsp; You do not need to be root to set this up, and I prefer to run Dropbox as an unprivileged user.&nbsp; In /home/raindog308 I ran these commands:</p><pre>wget -O dropbox-linux-x86_64.tar.gz https://www.dropbox.com/download?plat=lnx.x86_64\ntar xzf dropbox-linux-x86_64.tar.gz</pre><p>Once you do this, the .dropbox-dist is created.</p><p><span id=\"more-24095\"></span></p><p>Now you can run the Dropbox daemon.&nbsp; We\u2019ll automate this later, but since you need to link your device, do it manually the first time:</p><pre>~/.dropbox-dist/dropboxd</pre><p>After a few moments, you\u2019ll see a message like this:</p><pre>Please visit https://www.dropbox.com/cli_link_nonce?nonce=XXXxxxXXXxxxXXX to link this device.</pre><p>Click the link and then click Connect.</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iMTE4IiB2aWV3Qm94PSIwIDAgNTAwIDExOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-24096\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/07/dropbox1.png.webp\" alt=\"Dropbox Tutorial\" width=\"500\" height=\"118\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/07/dropbox1.png.webp 500w, https://lowendbox.com/wp-content/uploads/2020/07/dropbox1-300x71.png.webp 300w\" data-sizes=\"(max-width: 500px) 100vw, 500px\"></p><p>&nbsp;</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1MDAiIGhlaWdodD0iMTQ1IiB2aWV3Qm94PSIwIDAgNTAwIDE0NSI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"alignnone size-full wp-image-24097\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/07/dropbox2.png.webp\" alt=\"Dropbox Tutorial\" width=\"500\" height=\"145\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2020/07/dropbox2.png.webp 500w, https://lowendbox.com/wp-content/uploads/2020/07/dropbox2-300x87.png.webp 300w\" data-sizes=\"(max-width: 500px) 100vw, 500px\"></p><p>The daemon is still running (in the foreground).&nbsp; You can hit control-C to stop it.&nbsp; Below you can see how to start it via systemd.</p><h1>Installing the Dropbox CLI</h1><p>The Dropbox CLI program is a Python program that offers many commands.&nbsp; All you ned to do is download it:</p><pre>wget -O /usr/local/bin/dropbox.py https://www.dropbox.com/download?dl=packages/dropbox.py\nchmod 755 /usr/local/bin/dropbox.py</pre><p>I\u2019d recommend putting it somewhere in your path \u2013 perhaps in /usr/local/bin.</p><p>If you execute it, you\u2019ll see everything it can do:</p><pre>raindog308@server1:~$ ./dropbox.py \nDropbox command-line interface\n\ncommands:\n\nNote: use dropbox help &lt;command&gt; to view usage for a specific command.\n\nautostart automatically start Dropbox at login\nexclude ignores/excludes a directory from syncing\nfilestatus get current sync status of one or more files\nhelp provide help\nlansync enables or disables LAN sync\nls list directory contents with current sync status\nproxy set proxy settings for Dropbox\npuburl get public url of a file in your Dropbox's public folder\nrunning return whether Dropbox is running\nsharelink get a shared link for a file in your Dropbox\nstart start dropboxd\nstatus get current status of the dropboxd\nstop stop dropboxd\nthrottle set bandwidth limits for Dropbox\nupdate download latest version of Dropbox\nversion print version information for Dropbox</pre><h1>Using the Dropbox CLI</h1><p>One thing you may already be thinking is that you don\u2019t want your entire Dropbox folder on a VPS.&nbsp; The way to prevent this is to exclude folders.&nbsp; The syntax may be counter-intuitive to you.&nbsp; \u201cexclude add\u201d means \u201cadd to the exclude list\u201d not \u201cadd it to syncing\u201d.&nbsp; For example, if you have a folder called LowEndSecrets, you could exclude it like this:</p><pre>raindog308@server1:~/Dropbox$ dropbox.py exclude add LowEndSecrets\nExcluded: \nLowEndSecrets</pre><p>Then use \u201cexclude list\u201d to see what\u2019s excluded:</p><pre>raindog308@server1:~/Dropbox$ ../dropbox.py exclude list\nExcluded: \nLowEndSecrets</pre><p>And to reverse this:</p><pre>raindog308@server1:~/Dropbox$ ../dropbox.py exclude remove LowEndSecrets\nNo longer excluded: \nLowEndSecrets</pre><p>If you want to see synchronization status, use the \u201cstatus\u201d command:</p><pre>raindog308@server1:~/Dropbox$ ../dropbox.py status\nSyncing 157,389 files \u2022 2+ days\nIndexing 584 files (1 min)\nUploading 1 file...\nDownloading 156,804 files (13.8 KB/sec, 2+ days)</pre><p>(Note that in this example the slow sync rate is because this was a fresh install and Dropbox was busy synchronizing).</p><p>Here is an example a little while later once Dropbox was fully synchronized:</p><pre>raindog308@server1:~/Dropbox$ ../dropbox.py status\nUp to date</pre><p>To see the status of one folder, use \u201cfilestatus\u201d:</p><pre>raindog308@server1:~/Dropbox$ ../dropbox.py filestatus Travel\nTravel: syncing\n\nraindog308@server1:~/Dropbox$ ../dropbox.py filestatus Travel\nTravel: up to date</pre><h1>Automating Dropbox Startup</h1><p>You can use systemd to automate Dropbox start/stop.&nbsp; Here\u2019s a sample unit file.&nbsp; Place this in /etc/systemd/system/dropbox.service:</p><pre>[Unit]\nDescription=Dropbox\nAfter=network.target\n\n[Service]\nUser=raindog308\nExecStart=/usr/local/bin/dropbox.py start\nExecStop=/usr/local/bin/dropbox.py start\nType=forking\n\n[Install]\nWantedBy=multi-user.target</pre><p>Then simply:</p><pre>systemctl daemon-reload\nsystemctl enable dropbox\nsystemctl start dropbox</pre><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/amd-epyc-openvz-7-vps-in-strasbourg-france-europe-and-quebec-canada-starting-from-12-year-hostnamaste/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"HostNamaste Logo\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/12/hostnamaste300-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">AMD Epyc OpenVZ 7 VPS in Strasbourg, France, Europe and Quebec, Canada Starting from $12/year - Host...</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-use-cpulimit-on-centos-7/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to use CPULimit on CentOS 7\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/05/rntut_cpulimit-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to use CPULimit on CentOS 7</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/%f0%9f%8e%87-celebrate-fourth-of-july-with-some-cloudserver-deal-fireworks-2gb-vps-for-2-mo%f0%9f%8e%86/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"CloudServer Logo\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/11/cloudserver-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">\ud83c\udf87 Celebrate Fourth of July with Some CloudServer Deal Fireworks! (2GB VPS for $2/mo!)\ud83c\udf86</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/location-location-location-interview-with-quadranet-ceo-ilan-mishan/\"><div class=\"relpost-custom-block-single\" style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Quadranet Logo\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2021/07/20th-Anniversary-Logo-300-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Location, Location, Location: Interview with QuadraNet CEO Ilan Mishan</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}