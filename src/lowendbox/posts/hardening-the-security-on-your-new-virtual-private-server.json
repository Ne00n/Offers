{"id": "9146", "post": "<div class=\"post-9146 post type-post status-publish format-standard hentry category-tutorials tag-hardening tag-password tag-security tag-ssh-key\" id=\"post-9146\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/hardening-the-security-on-your-new-virtual-private-server/\" rel=\"bookmark\">Hardening the Security on your New Virtual Private Server</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/hardening/\" rel=\"tag\">hardening</a>, <a href=\"https://lowendbox.com/tag/password/\" rel=\"tag\">password</a>, <a href=\"https://lowendbox.com/tag/security/\" rel=\"tag\">Security</a>, <a href=\"https://lowendbox.com/tag/ssh-key/\" rel=\"tag\">ssh key</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> November 1, 2016 @ 7:50 am, by Jon Biloh</div><div class=\"storycontent tablelook\"><p style=\"text-align: center;\"><a href=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzEiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCAyNzEgNzAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNjZmQ0ZGIiLz48L3N2Zz4=\" loading=\"lazy\" class=\"alignnone size-full wp-image-3957\" data-src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" alt=\"lowendtutorial\" width=\"271\" height=\"70\"></a></p><p>Hardening the security on your VPS should be one of the first tasks you perform when buying a new VPS. As a result, we\u2019ve provided several tips that will help you increase the security on your VPS.</p><p>When you buy a VPS, your provider will likely send you a default root password for your server. You will need to change this password to a string that only you know. But that\u2019s just the start of what you should be doing to make sure your VPS is reasonably secure.</p><p>When you leave your password as the default password assigned by your hosting provider, your attack surface increases since someone will simply need to breach your email account in order to gain access to your VPS.</p><p><span id=\"more-9146\"></span></p><p>&nbsp;</p><p><strong>Changing Your Default Password</strong></p><p>To begin this process, ensure that you have at least one root SSH session active. Reason being, you won\u2019t be able to reset the password again if the test login fails after changing it\u2019s authentication. This little trick can potentially save you from having to contact your VPS provider for a password reset.</p><p>The importance of a strong password cannot be stressed. You can always use one of the many password generating tools available such as pwgen or mkpasswd. You can also generate a secure password online using the following website:</p><p><a href=\"http://passwordsgenerator.net\" target=\"_blank\">http://passwordsgenerator.net</a></p><p>Once you have chosen the password, make sure to memorize it or store it in a safe location (not a post-it note on your screen).</p><p>Next, let\u2019s assign the password. Execute the following command and type the password twice as asked:</p><pre class=\"code\">&gt;passwd\n</pre><p>As advised above, keep create a terminal root SSH connection open while performing the password change. Open another SSH connection and make sure you can log in with new password.</p><p>&nbsp;</p><p><strong>Using Key Authentication for Remote Connections to your VPS</strong></p><p>Another good way to avoid intruders is to connect to your VPS is by using Key Authentication.</p><p>Key file authentication increases security because it makes it even nearly impossible to gain unauthorized access to your VPS without the key file that you generate.</p><p>Let\u2019s start with generating RSA key on your workstation:</p><pre class=\"code\">&gt; ssh-keygen -b 2048 -t rsa\n</pre><p>The app will ask you for a password to guard your keys.</p><p>If you are using the app from a secure workstation you might not feel compelled to set one up. Having a password for your key files will only increase the security around your VPS since you can effectively restrict access to the repository for those authorized to access it.</p><p>The command will generate id_rsa and id_rsa.pub files in your .ssh directory.</p><p>Run the same command on your target VPS to create ~/.ssh folder with proper access credentials. After that, copy your own public RSA key from your computer:</p><pre class=\"code\">&gt; cat .ssh/id_rsa.pub | ssh root@YOUR-VPS-IP \u2018cat &gt;&gt; .ssh/authorized_keys'\n</pre><p>and apply proper permissions on your VPS:</p><pre class=\"code\">&gt; chmod 600 ~/.ssh/authorized_keys\n</pre><p>Open another ssh connection. Key authentication is tried by default; However, you can explicitly require it to connect (the below is run from your computer):</p><pre class=\"code\">ssh -i ~/.ssh/id_rsa root@your-VPS-IP\n</pre><p>&nbsp;</p><p><strong>Advanced Key Authentication Tasks</strong></p><p>If you want to completely replace the root password with the key file, you can change the following lines of your sshd configuration on your VPS:</p><pre class=\"code\">PermitRootLogin without-password\n\nPermitEmptyPasswords no\n\nPasswordAuthentication no\n</pre><p>After you have corrected the lines above, you must restart the sshd service to make them active:</p><pre class=\"code\">&gt; service sshd restart\n</pre><p>As we described above, it is a good idea to always keep another SSH session open while you make these vital configuration changes.</p><p>&nbsp;</p><p><strong>Configuring the Firewall of your VPS</strong></p><p>Another very important tip is to enable the firewall included with your distro. Many Linux operating systems already offer already a set of preconfigured rules, but we\u2019d like to recommend the following rules:</p><pre class=\"code\">&gt;iptables -A INPUT -p icmp -j ACCEPT\n\n&gt;iptables -A INPUT -p tcp -m tcp --dport 443 -j ACCEPT\n\n&gt;iptables -A INPUT -p tcp -m tcp --dport 22 -j ACCEPT\n\n&gt;iptables -A INPUT -p tcp -m tcp --dport 80 -j ACCEPT\n\n&gt;iptables -A INPUT -m state --state RELATED,ESTABLISHED -j ACCEPT\n\n&gt;iptables -P INPUT DROP\n</pre><p>This will leave the ICMP port, the SSH port and the web ports open (80 and 443).</p><p>If you always connect to your server from your home or office, you could avoid leaving the ICMP protocol open and add a source address to the SSH port rule.</p><p>By simply adding this rule, you will make it practically impossible to any intruder to gain access to your VPS. Another way to do this is to execute the following command:</p><pre class=\"code\">&gt; iptables -A INPUT -p tcp -m tcp \u2013s YOUR-IP-ADDRESS --dport 22 -j ACCEPT\n</pre><p>Once you have installed the appropriate firewall rules for your VPS, don\u2019t forget to save them so that they will be reloaded upon the reboot of the server. You can easily do that with these two commands:</p><pre class=\"code\">&gt;iptables-save &gt; /root/iptables-startup-rules\n</pre><pre class=\"code\">&gt;echo \u201ciptables-restore &lt; /root/iptables-startup-rules\u201d &gt;&gt; /etc/rc.local\n</pre><p>Now you have blocked all unnecessary communication to and from your VPS.</p><p>&nbsp;</p><p><strong>More Tips for Hardening VPS Security</strong></p><p>After your VPS is created, it will likely be probed and scanned by various different nodes on the internet. Some are harmless while others will be looking for security vulnerabilities to exploit.</p><p>With that in mind, the sooner you harden your security, the better it is for your VPS. Hardening your VPS a topic that books could be written about.</p><p>To help point you in the right direction, consider the following best practices for VPS security:</p><ul><li>Install security updates for your VPS when necessary; especially if those relate to kernel and/or crucial OS components. You can visit <a href=\"http://www.linuxsecurity.com\" target=\"_blank\">com</a> and look for its advisories.</li></ul><ul><li>Do not log in as root. Create another account, create key authentication for it and make that account a sudoer</li></ul><ul><li>Only install software that you absolutely need and avoid using software from untrusted sources.</li></ul><ul><li>Backup your data! If your provider allows creating entire VPS backups/snapshots, frequently utilize this service on a daily or weekly basis.</li></ul><ul><li>If data backup isn\u2019t available to you through your providers, install backup software and make a copy of the important data on your VPS. Even the most secure systems are prone to a crash or you might delete a file by accident. In these cases, a good backup scheme will potentially save you hours of work.</li></ul><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fhardening-the-security-on-your-new-virtual-private-server%2F&amp;t=Hardening%20the%20Security%20on%20your%20New%20Virtual%20Private%20Server\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Hardening%20the%20Security%20on%20your%20New%20Virtual%20Private%20Server&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fhardening-the-security-on-your-new-virtual-private-server%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fhardening-the-security-on-your-new-virtual-private-server%2F&amp;title=Hardening%20the%20Security%20on%20your%20New%20Virtual%20Private%20Server&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">10</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendprotection-homemade-raspberry-pi-security-cloud-camera-setup/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/07/rpi_security1-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/shields-up-protecting-your-wordpress-site-with-wordfence/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Shields Up! Protecting Your WordPress Site with Wordfence\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Shields Up! Protecting Your WordPress Site with Wordfence</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/increasing-security-on-your-linux-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Increasing Security on Your Linux VPS\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/06/increasing-security-on-your-linux-vps-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Increasing Security on Your Linux VPS</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-3/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Generating and Using SSH Keys, Part 3\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/how-to-secure-wordpress-site-p3-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Generating and Using SSH Keys, Part 3</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/jbiloh/\" title=\"All posts by Jon Biloh\" rel=\"author\">Jon Biloh</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/f766d6dc4b5f406b9f3cb0339d48de95?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/f766d6dc4b5f406b9f3cb0339d48de95?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/jbiloh\" class=\"bio-icon bio-icon-website\"></a><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"http://Jbiloh\" class=\"bio-icon bio-icon-twitter\"></a><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.linkedin.com/in/jon-biloh-4b32598/\" class=\"bio-icon bio-icon-linkedin\"></a><p class=\"bio-description\">I'm Jon Biloh and I own LowEndBox and LowEndTalk. I've spent my nearly 20 year career in IT building companies and now I'm excited to focus on building and enhancing the community at LowEndBox and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}