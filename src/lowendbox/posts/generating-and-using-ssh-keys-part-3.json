{"id": "22374", "post": "<div class=\"post-22374 post type-post status-publish format-standard hentry category-tutorials tag-security tag-ssh tag-sshkeys tag-sshsecurity tag-tutorial tag-wordpresssecurity\" id=\"post-22374\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-3/\" rel=\"bookmark\">Generating and Using SSH Keys, Part 3</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/security/\" rel=\"tag\">Security</a>, <a href=\"https://lowendbox.com/tag/ssh/\" rel=\"tag\">ssh</a>, <a href=\"https://lowendbox.com/tag/sshkeys/\" rel=\"tag\">sshkeys</a>, <a href=\"https://lowendbox.com/tag/sshsecurity/\" rel=\"tag\">sshsecurity</a>, <a href=\"https://lowendbox.com/tag/tutorial/\" rel=\"tag\">tutorial</a>, <a href=\"https://lowendbox.com/tag/wordpresssecurity/\" rel=\"tag\">wordpresssecurity</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> September 26, 2020 @ 6:02 am, by raindog308</div><div class=\"storycontent tablelook\"><p><a><img data-lazyloaded=\"1\" src=\"https://lowendbox.com/wp-content/uploads/2020/04/how-to-secure-wordpress-site-p3.png.webp\" loading=\"lazy\" class=\"screenshot litespeed-loaded\" data-src=\"https://lowendbox.com/wp-content/uploads/2020/04/how-to-secure-wordpress-site-p3.png.webp\" alt=\"\" width=\"416\" height=\"245\" data-was-processed=\"true\"></a></p><p class=\"p1\"><span class=\"s1\">In <a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-1\">previous</a> <a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-2\">tutorials</a> in this series, we went over generating SSH keys and how to use them.<span class=\"Apple-converted-space\">&nbsp; </span>We\u2019ll wrap up the series by showing you how to turn off password authentication on your server.</span></p><h1 class=\"p1\"><span class=\"s1\">Why Configure for SSH Key Authentication Only</span></h1><p class=\"p1\"><span class=\"s1\">As mentioned in <a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-1\">Part 1</a>, SSH key authentication requires both \u201csomething you know\u201d (the passphrase) and \u201csomething you have\u201d (the SSH private key file).<span class=\"Apple-converted-space\">&nbsp; </span>Some attacker on the other side of the world might guess or brute force your password, or if you\u2019re sloppy you might reuse it on some breached web site.<span class=\"Apple-converted-space\">&nbsp; </span>But none of that matters if the bad guy doesn\u2019t have your SSH private key file.</span></p><p class=\"p1\"><span class=\"s1\">This doesn\u2019t mean you shouldn\u2019t still use strong passphrases with your SSH private key file.<span class=\"Apple-converted-space\">&nbsp; </span>If for some reason, your client system (such as your home PC or laptop) was compromised, then security rests with this passphrase, so follow normal best practices for strong passphrases.</span></p><p><span id=\"more-22374\"></span></p><h1 class=\"p1\"><span class=\"s1\">Disabling Password Authentication</span></h1><p class=\"p1\"><span class=\"s1\">First, test that SSH key authentication works (see <a href=\"https://lowendbox.com/blog/generating-and-using-ssh-keys-part-2\">Part 2</a>) so you don\u2019t lock yourself out.</span></p><p class=\"p1\"><span class=\"s1\">Using your favorite editor (such as vi or nano), edit the /etc/ssh/sshd_config file.<span class=\"Apple-converted-space\">&nbsp; </span>The location is the same on both Debian- and CentOS-based systems.</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>sudo vi /etc/ssh/sshd_config</span></pre><p class=\"p1\"><span class=\"s1\">Change these lines as follows:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>PubkeyAuthentication yes</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>PasswordAuthentication no</span></pre><p class=\"p1\"><span class=\"s1\">Then restart sshd:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>systemctl restart sshd</span><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp;&nbsp;</span></span></pre><p class=\"p1\"><span class=\"s1\">Now try to login.<span class=\"Apple-converted-space\">&nbsp; </span>Here I will use an account that was setup and has not had an ssh key configured:</span></p><pre class=\"p1\"><span class=\"s1\"><span class=\"Apple-converted-space\">&nbsp; &nbsp; </span>$ ssh testuser@myserver</span>\n<span class=\"s1\"><span class=\"Apple-converted-space\">  &nbsp; </span>Permission denied (publickey,gssapi-keyex,gssapi-with-mic). </span></pre><h1 class=\"p1\"><span class=\"s1\">Wrapping Up</span></h1><p class=\"p1\"><span class=\"s1\">Here are the key takeaways from this series:</span></p><ul><li class=\"p1\"><span class=\"s1\">SSH key authentication is based on public key encryption.<span class=\"Apple-converted-space\">&nbsp; </span>The private key should be zealously protected.<span class=\"Apple-converted-space\">&nbsp; </span>On the other hand, the public key does not need to be kept secret.<span class=\"Apple-converted-space\">&nbsp; </span>The public key is what is installed on various servers you wish to connect to.</span></li><li class=\"p1\"><span class=\"s1\">SSH key authentication is superior to passwords because it requires the user to have the SSH key file in his/her possession, not merely know a secret passphrase.</span></li><li class=\"p1\"><span class=\"s1\">You should set a solid passphrase on your SSH private key file in case it is lost/stolen/compromised.</span></li><li class=\"p1\"><span class=\"s1\">The ssh-copy-id utility allows you to very easily setup your SSH key on remote systems if you have a Linux or macOS client.<span class=\"Apple-converted-space\">&nbsp; </span>On Windows, you\u2019ll need to proceed with manual steps.</span></li><li class=\"p1\"><span class=\"s1\">Disabling password authentication on your servers completes the security setup.<span class=\"Apple-converted-space\">&nbsp; </span>Once done, the security of your server is significantly improved.</span></li></ul><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fgenerating-and-using-ssh-keys-part-3%2F&amp;t=Generating%20and%20Using%20SSH%20Keys%2C%20Part%203\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Generating%20and%20Using%20SSH%20Keys%2C%20Part%203&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fgenerating-and-using-ssh-keys-part-3%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fgenerating-and-using-ssh-keys-part-3%2F&amp;title=Generating%20and%20Using%20SSH%20Keys%2C%20Part%203&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">3</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/managing-your-lowendempire-with-ansible-part-1/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Managing Your LowEndEmpire With Ansible, Part 1\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Managing Your LowEndEmpire With Ansible, Part 1</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendprotection-homemade-raspberry-pi-security-cloud-camera-setup/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/07/rpi_security1-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/setup-a-dns-nameserver-using-nsd/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Setup a DNS Nameserver Using NSD\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Setup a DNS Nameserver Using NSD</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/keeping-a-logwatchful-eye-on-your-vps-with-logwatch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Keeping A (log)Watchful Eye on Your VPS With logwatch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/logwatch-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Keeping A (log)Watchful Eye on Your VPS With logwatch</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/raindog308/\" title=\"All posts by raindog308\" rel=\"author\">raindog308</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4ce3b8640a70e05bd73ac25b8a37821c?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><a target=\"_blank\" rel=\"nofollow noopener noreferrer\" href=\"https://www.lowendtalk.com/profile/raindog308\" class=\"bio-icon bio-icon-website\"></a><p class=\"bio-description\">I'm Andrew, techno polymath and long-time LowEndTalk community Moderator. My technical interests include all things Unix, perl, python, shell scripting, and relational database systems. I enjoy writing technical articles here on LowEndBox to help people get more out of their VPSes.</p></div></div><div class=\"feedback\"></div></div>"}