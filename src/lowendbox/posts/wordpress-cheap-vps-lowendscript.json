{"id": "1101", "post": "<div class=\"post-1101 post type-post status-publish format-standard hentry category-tutorials tag-lowendscript\" id=\"post-1101\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/wordpress-cheap-vps-lowendscript/\" rel=\"bookmark\">Bootstraping WordPress/Nginx/PHP/MySQL on a Cheap VPS with lowendscript</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/lowendscript/\" rel=\"tag\">lowendscript</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> July 28, 2010 @ 1:07 am, by LowEndAdmin</div><div class=\"storycontent tablelook\"><p>One constantly posted question on LowEndBox and <a href=\"http://www.lowendtalk.com/\">LowEndTalk</a> is \u2014 how to get the same setup as LowEndBox, a WordPress site that runs on cheap VPS with 80MB of memory? Instead of doing a step-by-step explanation (<em>damn I hate writing long blog posts</em>), I decided to wrap it into a bash script that <em>does it all</em>.</p><table cellspacing=\"10\" cellpadding=\"0\" align=\"center\"><tbody><tr valign=\"top\"><td><img data-lazyloaded=\"1\" src=\"/media/pix/nginx.png\" data-src=\"/media/pix/nginx.png\" alt=\"Nginx\" class=\"litespeed-loaded\" data-was-processed=\"true\"></td><td><img data-lazyloaded=\"1\" src=\"/media/pix/php.png\" data-src=\"/media/pix/php.png\" alt=\"PHP\" class=\"litespeed-loaded\" data-was-processed=\"true\"></td></tr><tr valign=\"top\"><td><img data-lazyloaded=\"1\" src=\"/media/pix/wordpress.png\" data-src=\"/media/pix/wordpress.png\" alt=\"WordPress\" class=\"litespeed-loaded\" data-was-processed=\"true\"></td><td><img data-lazyloaded=\"1\" src=\"/media/pix/mysql.png\" data-src=\"/media/pix/mysql.png\" alt=\"MySQL\" class=\"litespeed-loaded\" data-was-processed=\"true\"></td></tr></tbody></table><p>It is based on <a href=\"/blog/bootstraping-low-end-vps-with-pre-built-scripts/\">my previous script here</a>, and it has been tested on both Debian 5 \u201cLenny\u201d and Ubuntu 10.04 \u201cLucid Lynx\u201d. Sorry no other distributions are supported. It is currently <a href=\"http://github.com/lowendbox/lowendscript\">hosted at github</a> so feel free to branch it and tune it to your heart\u2019s desire.</p><p><span id=\"more-1101\"></span></p><h3>Usage</h3><p>Here is a quick step by step on how to set up a WordPress blog running on Nginx, PHP/FastCGI and MySQL on a low end box. Let\u2019s assume that you are going to set up a blog on hostname \u201c<tt>blog.example.com</tt>\u201c.</p><ol><li>Go and buy a <a href=\"https://lowendbox.com/\">cheap VPS</a>. Yes, you know where to find cheap virtual servers under $7/month, don\u2019t you? :) I am using my <a href=\"/blog/rackvm-6-gbpyear-128mb-openvz-vps-in-uk-exclusive-offer/\">6 pound/year RackVM VPS with 128MB memory</a> to test this script, and the performance turns out to be quite good. YMMV.<p>Make sure it is either a Debian or a Ubuntu distro though.</p></li><li>After gaining root access to your VPS,<pre class=\"code\"># <b>wget --no-check-certificate https://github.com/lowendbox/lowendscript/raw/master/setup-debian.sh</b>\n...\n# <b>bash setup-debian.sh system</b>\n...\n# <b>bash setup-debian.sh exim4</b>\n...\n# <b>bash setup-debian.sh nginx</b>\n...\n# <b>bash setup-debian.sh mysql</b>\n...\n# <b>bash setup-debian.sh php</b>\n...\n# <b>bash setup-debian.sh wordpress blog.example.com</b>\n...\n</pre></li><li>Now altering your DNS entry to point <code>blog.example.com</code> to your new VPS (or alter your local <code>/etc/hosts</code> entry). Navigate to it from your browser, and you should be presented with WordPress set up page. Fill in your blog\u2019s name, admin\u2019s password and contact email, and your new WordPress is online!<p>Just repeat the last step (running <code>bash setup-debian.sh wordpress <em>&lt;hostname&gt;</em></code>) to set up more blogs on the same box.</p></li></ol><p>That\u2019s it!</p><h3>Software Stack</h3><p>It\u2019s pretty similar to my own stack that runs LowEndBox.com.</p><ul><li><a href=\"http://matt.ucc.asn.au/dropbear/dropbear.html\">dropbear</a> to replace openssh. Invoked from xinetd.</li><li><a href=\"http://packages.debian.org/inetutils-syslogd\">inetutils-syslogd</a> to replace rsyslog.</li><li><a href=\"http://www.exim.org/\">exim4</a> to replace sendmail (if installed). Re-configured to allow Internet delivery.</li><li><a href=\"http://packages.debian.org/cron\">cron</a></li><li><a href=\"http://nginx.net/\">nginx</a></li><li><a href=\"http://www.mysql.com/\">mysql</a>. Re-configured to remove innodb support, remove query cache and reduce key buffer size.</li><li><a href=\"http://php.net/\">php</a> with built-in FastCGI interface. Running only 1 child process and respawn after 5,000 requests.</li></ul><p>The lowendscript is also</p><ul><li>Removing some commonly bundled applications that should not be there in the first place for a minimal distro (apache2, sendmail, bind9, samba, nscd, etc).</li><li>MySQL root is given a new password (which can be found in <code>~root/.my.cnf</code>)</li><li>Installing each WordPress site under /var/www/<em>&lt;hostname&gt;</em>. It will create appropriate database, users and password for the site.</li></ul><p>I have to say that it is still \u201cwork in progress\u201d, but if you want to figure out the internals please check the source code of that bash script.</p><h3>Memory Usage</h3><p>I am testing the same script on the following 3 systems:</p><ul><li>Ubuntu 10.04 64bit (RackVM)</li><li>Debian 5 64bit (RackVM)</li><li>Debian 5 32bit (VPSGuy)</li></ul><p>They are all showing different memory usage. I am taking the snapshot of memory usage <b>AFTER</b> 10 page loads on the WordPress blog that has been created to ensure PHP process is fully loaded.</p><h4>Ubuntu 10.04 64bit</h4><pre class=\"code\">root@ubuntu64:~# <b>ps aux</b>\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.5  23300  1536 ?        Ss   06:58   0:00 init\nroot     10124  0.0  0.5  23576  1496 ?        Ss   07:34   0:00 dropbear -i\nroot     15742  0.0  0.7  17880  1944 pts/0    Ss   07:35   0:00 -bash\nroot     15754  0.0  0.4  14960  1084 pts/0    R+   07:35   0:00 ps aux\nroot     24290  0.0  0.3  12508   788 ?        S    07:22   0:00 /usr/sbin/syslo\nroot     24524  0.0  0.3  21064  1004 ?        Ss   07:22   0:00 cron\nroot     25689  0.0  0.3  19512   972 ?        Ss   07:22   0:00 /usr/sbin/xinet\nmysql    26346  0.0  4.2  61812 11248 ?        Ssl  07:23   0:00 /usr/sbin/mysql\nwww-data 27920  0.0  2.6  87768  7048 ?        Ss   07:23   0:00 /usr/bin/php-cg\nwww-data 27922  0.5 15.0 122460 39432 ?        S    07:23   0:04 /usr/bin/php-cg\n103      30162  0.0  0.3  44356  1000 ?        Ss   07:24   0:00 /usr/sbin/exim4\nroot     30267  0.0  0.3  28104   932 ?        Ss   07:24   0:00 nginx: master p\nwww-data 30268  0.0  0.8  28744  2196 ?        S    07:24   0:00 nginx: worker p\n\nroot@ubuntu64:~# <b>free</b>\n             total       used       free     shared    buffers     cached\nMem:        262144     100500     161644          0          0          0\n-/+ buffers/cache:     100500     161644\nSwap:            0          0          0\n</pre><p>Memory Usage: <b>98.1MB</b></p><h4>Debian 5 64bit</h4><pre class=\"code\">debian64:~# <b>ps aux</b>\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.2  10304   740 ?        Ss   12:22   0:00 init [2]\n106       1414  0.0  0.3  42708  1004 ?        Ss   12:26   0:00 /usr/sbin/exim4\nwww-data  1655  0.0  2.5  72028  6560 ?        Ss   12:26   0:00 /usr/bin/php-cg\nwww-data  1657  0.9 11.7  98500 30928 ?        S    12:26   0:03 /usr/bin/php-cg\nwww-data  3126  0.0  0.7  28380  1912 ?        S    12:29   0:00 nginx: worker p\nroot      7668  0.1  0.5  23340  1528 ?        Rs   12:31   0:00 dropbear -i\nroot      7831  0.0  0.6  17472  1716 pts/0    Ss   12:32   0:00 -bash\nroot      7836  0.0  0.3  14720   980 pts/0    R+   12:32   0:00 ps aux\nroot     20169  0.0  0.3  18540   936 ?        Ss   12:22   0:00 /usr/sbin/cron\nroot     24462  0.0  0.2  12236   732 ?        S    12:25   0:00 /usr/sbin/syslo\nroot     25637  0.0  0.3  19256   952 ?        Ss   12:25   0:00 /usr/sbin/xinet\nroot     25694  0.0  0.5  28380  1552 ?        Ss   12:25   0:00 nginx: master p\nroot     32427  0.0  0.2   3872   588 ?        S    12:26   0:00 /bin/sh /usr/bi\nmysql    32466  0.0  3.0  50420  8124 ?        Sl   12:26   0:00 /usr/sbin/mysql\nroot     32468  0.0  0.2   3772   592 ?        S    12:26   0:00 logger -p daemo\n\ndebian64:~# <b>free</b>\n             total       used       free     shared    buffers     cached\nMem:        262144      61008     201136          0          0          0\n-/+ buffers/cache:      61008     201136\nSwap:            0          0          0\n</pre><p>Memory Usage: <b>59.6MB</b></p><h4>Debian 5 32bit</h4><pre class=\"code\">debian32:~# <b>ps aux</b>\nUSER       PID %CPU %MEM    VSZ   RSS TTY      STAT START   TIME COMMAND\nroot         1  0.0  0.1   1980   688 ?        Ss   23:34   0:00 init [2]\nroot     14064  0.0  0.1   1704   512 ?        S    23:52   0:00 /bin/sh /usr/bi\nmysql    14119  0.0  1.7  20056  6968 ?        Sl   23:52   0:00 /usr/sbin/mysql\nroot     14120  0.0  0.1   1628   536 ?        S    23:52   0:00 logger -p daemo\nwww-data 15968  0.0  1.2  16352  4996 ?        Ss   23:53   0:00 /usr/bin/php-cg\nwww-data 15971  0.5  4.7  29436 18576 ?        S    23:53   0:01 /usr/bin/php-cg\nroot     16040  0.0  0.3   2700  1464 ?        Rs   23:53   0:00 dropbear -i\nroot     16119  0.0  0.1   1880   684 ?        S    23:44   0:00 /usr/sbin/syslo\nroot     16133  0.0  0.3   2780  1536 pts/0    Ss   23:54   0:00 -bash\nroot     17728  0.0  0.2   2352   896 ?        Ss   23:45   0:00 /usr/sbin/xinet\nwww-data 17758  0.0  0.3   5004  1488 ?        S    23:54   0:00 nginx: worker p\nroot     27834  0.0  0.3   4548  1236 ?        Ss   23:47   0:00 nginx: master p\nroot     28146  0.0  0.2   2296   896 pts/0    R+   23:57   0:00 ps aux\n102      32065  0.0  0.2   6104   900 ?        Ss   23:49   0:00 /usr/sbin/exim4\n\ndebian32:~# <b>free</b>\n             total       used       free     shared    buffers     cached\nMem:        262144      44272     217872          0          0          0\n-/+ buffers/cache:      44272     217872\nSwap:            0          0          0\n</pre><p>Memory Usage: <b>43.2MB</b></p><p>So to put that in summary form</p><ul><li>Ubuntu 10.04 uses significantly more memory than Debian 5 (PHP5.3/MySQL5.1 vs. PHP5.2/MySQL5.0). So pick your distro wisely and maybe you don\u2019t need the latest and greatest if your application does not need it.</li><li>32bit also uses quite a bit less than 64bit, running exactly the same version of stack. That pretty much <a href=\"/blog/32bit-or-64bit-for-my-low-end-vps-take-2/\">confirms what I posted before</a>.</li></ul><p>And hopefully the above script is useful for your next WordPress splog farm :P</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fwordpress-cheap-vps-lowendscript%2F&amp;t=Bootstraping%20WordPress%2FNginx%2FPHP%2FMySQL%20on%20a%20Cheap%20VPS%20with%20lowendscript\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Bootstraping%20WordPress%2FNginx%2FPHP%2FMySQL%20on%20a%20Cheap%20VPS%20with%20lowendscript&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fwordpress-cheap-vps-lowendscript%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fwordpress-cheap-vps-lowendscript%2F&amp;title=Bootstraping%20WordPress%2FNginx%2FPHP%2FMySQL%20on%20a%20Cheap%20VPS%20with%20lowendscript&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">3</span><span>shares</span></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/admin/\" title=\"All posts by LowEndAdmin\" rel=\"author\">LowEndAdmin</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/11a4d9191634a9374eeca7d0e8982ba2?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/11a4d9191634a9374eeca7d0e8982ba2?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">The original owner of LowEndBox known as \"LowEndAdmin\" or \"LEA\" for short founded LowEndBox in 2008 and created the concept of hosting applications on low resource \"Low End Boxes\". After creating the roots of the community that we know today, \"LEA\" stepped aside and allowed others to carry the torch forward.</p></div></div><div class=\"feedback\"></div></div>"}