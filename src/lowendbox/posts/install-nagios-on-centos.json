{"id": "4110", "post": "<div class=\"post-4110 post type-post status-publish format-standard hentry category-tutorials tag-tutorials-2\" id=\"post-4110\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/install-nagios-on-centos/\" rel=\"bookmark\">Install Nagios (CentOS) for Server Monitoring</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \"> <a href=\"https://lowendbox.com/tag/tutorials-2/\" rel=\"tag\">tutorials</a> <img data-lazyloaded=\"1\" src=\"data:image/gif;base64,R0lGODdhAQABAPAAAMPDwwAAACwAAAAAAQABAAACAkQBADs=\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \"> July 20, 2013 @ 9:31 am, by Maarten Kossen</div><div class=\"storycontent tablelook\"><p style=\"text-align: center;\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNzEiIGhlaWdodD0iNzAiIHZpZXdCb3g9IjAgMCAyNzEgNzAiPjxyZWN0IHdpZHRoPSIxMDAlIiBoZWlnaHQ9IjEwMCUiIGZpbGw9IiNjZmQ0ZGIiLz48L3N2Zz4=\" loading=\"lazy\" class=\"alignnone size-full wp-image-3957\" data-src=\"https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial.png.webp\" alt=\"lowendtutorial\" width=\"271\" height=\"70\"></p><p>Nagios is one of the most easy, expandable and trustworthy ways to <a href=\"https://www.nagios.org/\">monitor the status of your server</a>(s). It is highly configurable and even lets you write your own plugins in whatever language you want.</p><p>This article will focus on installing nagios on a single server (and monitor just that server). In order to monitor more than just the nagios server, see my <a href=\"https://lowendbox.com/blog/remote-server-monitoring-with-nagios/\">Remote server monitoring with Nagios </a>article. It will be up for CentOS next week. In the context of that article, this will be the nagios server.</p><p>This article also assumes you use a recent version of RHEL/CentOS, but could very well work on other distributions as well. I\u2019ve also assumed you\u2019ve already added EPEL.<br>\n<span id=\"more-4110\"></span></p><h2>Installing Nagios up and running on CentOS</h2><p>Getting Nagios up and running in itself is actually pretty easy.</p><p>First make sure the system is up-to-date:</p><blockquote><p>yum update</p></blockquote><p>Once that\u2019s done, we can now start by installing Nagios and a few plugins:</p><blockquote><p>yum install nagios nagios-plugins-load nagios-plugins-swap nagios-plugins-ssh nagios-plugins-http nagios-plugins-ping nagios-plugins-disk nagios-plugins-procs nagios-plugins-users</p></blockquote><p>It\u2019s a lot of packages, as you may notice. That\u2019s because all nagios plugins are separate packages. This can actually be quite nice since you don\u2019t have all the plugins present that you don\u2019t need.</p><p>Finally, let\u2019s set the password for nagiosadmin. The default is \u2018nagiosadmin\u2019 and it\u2019s not that good ;-) To change the password, use:</p><blockquote><p>htpasswd /etc/nagios/passwd nagiosadmin</p></blockquote><p>It will then prompt for your password twice.</p><p>That\u2019s it! You\u2019ve now got Nagios up and running. If you go to http://example.net/nagios and log in with \u2018nagiosadmin\u2019 and the password you just entered, you\u2019ll see the Nagios Web Interface. If you click \u2018Services\u2019 in the left-hand menu, you\u2019ll see localhost listed and some checks on \u2018OK\u2019 and some checks on \u2018Pending\u2019. Eventually, they should all become green and \u2018OK\u2019. Nagios just needs some time for the initial checks.</p><p><strong>Getting it all working</strong></p><p>On Ubuntu, there was a lot to be done before Nagios was actually working completely. For example: scheduling downtime wasn\u2019t possible without some tweaking.&nbsp; On CentOS, however, it just works out of the box! So, let\u2019s head on and define our first contact\u2026</p><p><strong>Defining a contact</strong><br>\nNow that we\u2019ve got nagios up and running and have our initial checks for localhost in place, let\u2019s make sure we do get e-mail when something goes wrong.</p><p>Open up the templates configuration file (vim /etc/nagios/objects/templates.cfg) and look for a code block like this:</p><blockquote><p>define contact{<br>\nname generic-contact<br>\nservice_notification_period 24\u00d77<br>\nhost_notification_period 24\u00d77<br>\nservice_notification_options w,u,c,r,f,s<br>\nhost_notification_options d,u,r,f,s<br>\nservice_notification_commands notify-service-by-email<br>\nhost_notification_commands notify-host-by-email<br>\nregister 0<br>\n}</p></blockquote><p>Let\u2019s explain what you\u2019re seeing here and how you\u2019re going to be receiving e-mail.</p><p>The first line defines the name of the contact (which is actually a template contact).</p><p>The next two lines refer to a time period from /etc/nagios/objects/timeperiods.cfg. In that file, several time periods are configured per day. Check the file out to see which time periods are available. We\u2019re using the timeperiod_name as listed in the timeperiods file in our contacts file:</p><blockquote><p>service_notification_period 24\u00d77<br>\nhost_notification_period 24\u00d77</p></blockquote><p>Those two lines tell us during which time period to send notifications for service and host problems respectively, but only to this contact. You probably see the flexibility we\u2019ve got here.</p><p>Next we look at the type of service/host states we will be receiving notifications for:</p><blockquote><p>service_notification_options w,u,c,r,f,s<br>\nhost_notification_options d,u,r,f,s</p></blockquote><p>This is set to send notifications when a service is WARNING (w), UNKOWN (u), CRITICAL (c), when it recovers from a problem (r), when it is flapping (f) or when there\u2019s scheduled downtime (s). For hosts, we get notified when they are DOWN (d), UNKNOWN (u), when it recovers from a problem (r), when it\u2019s status is flapping (f) or when there\u2019s scheduled downtime (s). You can specify to receive no notifications at all for a certain type (service or host) by putting an \u2018n\u2019 there.</p><p>The next two lines refer to commands defined in the commands file /etc/nagios/objects/commands.cfg. Open up this file and look around a bit. In our contacts configuration it looks like this:</p><blockquote><p>service_notification_commands notify-service-by-email<br>\nhost_notification_commands notify-host-by-email</p></blockquote><p>When a service notification is going to be sent, it uses the command defined in notify-service-by-email and sends out the e-mail. Same goes for host notifications. Feel free to customize the e-mail in the commands file.</p><p>The last line of this file turns this contact into a template:</p><blockquote><p>register 0</p></blockquote><p>Which means this contact isn\u2019t actually registered as one.</p><p>Now, on to the actual contact. Open up /etc/nagios/objects/contact.cfg and look for a block like this:</p><blockquote><p>define contact{contact_name nagiosadmin<br>\nuse generic-contact<br>\nalias Nagios Admin<br>\nemail nagios@localhost<br>\n}</p></blockquote><p>The first line is an identifier for this contact. It would be best if it didn\u2019t contain spaces.</p><p>The second line tells Nagios that this contact inherits the configuration from \u2018generic-contact\u2019, which is the one I\u2019ve just shown you above.</p><p>The third line is an alias for this contact: it can be whatever you want.</p><p>The last line of this configuration file is what we\u2019ve actually been looking for. The e-mail setting:</p><blockquote><p>email nagios@localhost</p></blockquote><p>This is where you can define your own e-mail address. When done, reload nagios:</p><blockquote><p>sudo service nagios reload</p></blockquote><p>And you should be receiving e-mail notifications when a problem occurs.</p><h2>A closing word on Nagios for CentOS</h2><p>There\u2019s a lot more to tell about nagios, but you\u2019ve probably already noticed that. I\u2019ve referred to several files which we\u2019ve not handled in detail. The most important next thing is monitoring remote servers and defining checks. For that, I recommend you read my article \u2018Remote server monitoring with Nagios\u2019 which is a follow-up to this one. In that article, we\u2019re going to add a remote server and define a host check. The host check definition explained there can also be used on localhost.</p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Finstall-nagios-on-centos%2F&amp;t=Install%20Nagios%20%28CentOS%29%20for%20Server%20Monitoring\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=Install%20Nagios%20%28CentOS%29%20for%20Server%20Monitoring&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Finstall-nagios-on-centos%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Finstall-nagios-on-centos%2F&amp;title=Install%20Nagios%20%28CentOS%29%20for%20Server%20Monitoring&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">0</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/centos-6-end-of-life-is-coming-upgrade-to-a-new-centos-7-vps-now/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"CentOS 6 End of Life is Coming! Upgrade to a new CentOS 7 VPS Now\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/centos-6-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">CentOS 6 End of Life is Coming! Upgrade to a new CentOS 7 VPS Now</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/best-web-hosting-control-panels-after-the-cpanel-price-hike/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Best Web Hosting Control Panels after the cPanel Price Hike\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/03/leb-banner-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Best Web Hosting Control Panels after the cPanel Price Hike</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-set-up-plex-media-server-on-your-vps/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How to Set Up Plex Media Server on Your Cheap VPS\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/how-to-set-up-plex-media-server-on-vps-2-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How to Set Up Plex Media Server on Your Cheap VPS</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/how-to-create-a-dns-server-on-debian-stretch/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"How To Create a DNS Server On Debian Stretch\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/leb-centered-small.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">How To Create a DNS Server On Debian Stretch</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/mpkossen/\" title=\"All posts by Maarten Kossen\" rel=\"author\">Maarten Kossen</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/67eeccea1ee5a1ce2f93adc061f69a5f?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\">Maarten Kossen was the administrator of LowEndBox from 2013 to 2015, and brought many ideas and improvements to the website during his leadership. Today he is member of our community and LowEndTalk.</p></div></div><div class=\"feedback\"></div></div>"}