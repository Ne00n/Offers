{"id": "19970", "post": "<div class=\"post-19970 post type-post status-publish format-standard hentry category-tutorials tag-apache tag-cerbot tag-lamp tag-lets-encrypt tag-linux tag-mariadb tag-mysql tag-php tag-php-7-3 tag-php-fpm tag-ssl tag-virtual-hosting tag-wordpress tag-wp-cli\" id=\"post-19970\"><h2 class=\"storytitle\"><a href=\"https://lowendbox.com/blog/centos-7-lamp-server-wordpress-wp-cli/\" rel=\"bookmark\">CentOS 7 LAMP Server Tutorial Part 4: WordPress and wp-cli</a></h2><div class=\"meta\"><img data-lazyloaded=\"1\" src=\"/media/icons/tag_green.png\" data-src=\"/media/icons/tag_green.png\" alt=\"Tags: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> <a href=\"https://lowendbox.com/tag/apache/\" rel=\"tag\">apache</a>, <a href=\"https://lowendbox.com/tag/cerbot/\" rel=\"tag\">cerbot</a>, <a href=\"https://lowendbox.com/tag/lamp/\" rel=\"tag\">LAMP</a>, <a href=\"https://lowendbox.com/tag/lets-encrypt/\" rel=\"tag\">Let's Encrypt</a>, <a href=\"https://lowendbox.com/tag/linux/\" rel=\"tag\">linux</a>, <a href=\"https://lowendbox.com/tag/mariadb/\" rel=\"tag\">mariadb</a>, <a href=\"https://lowendbox.com/tag/mysql/\" rel=\"tag\">mysql</a>, <a href=\"https://lowendbox.com/tag/php/\" rel=\"tag\">PHP</a>, <a href=\"https://lowendbox.com/tag/php-7-3/\" rel=\"tag\">php 7.3</a>, <a href=\"https://lowendbox.com/tag/php-fpm/\" rel=\"tag\">PHP-FPM</a>, <a href=\"https://lowendbox.com/tag/ssl/\" rel=\"tag\">ssl</a>, <a href=\"https://lowendbox.com/tag/virtual-hosting/\" rel=\"tag\">virtual hosting</a>, <a href=\"https://lowendbox.com/tag/wordpress/\" rel=\"tag\">wordpress</a>, <a href=\"https://lowendbox.com/tag/wp-cli/\" rel=\"tag\">wp-cli</a> <img data-lazyloaded=\"1\" src=\"https://lowendbox.com/media/icons/calendar.png\" data-src=\"https://lowendbox.com/media/icons/calendar.png\" alt=\"Date/Time: \" class=\"litespeed-loaded\" data-was-processed=\"true\"> June 15, 2019 @ 6:00 am, by Ryan Flowers</div><div class=\"storycontent tablelook\"><p>Welcome to the fourth installment of the CentOS 7 LAMP Server Tutorial: Modernized and Explained series.In <a href=\"http://lowendbox.com/blog/centos-7-lamp-server-tutorial-modernized-and-explained-part-1/\" target=\"_blank\" rel=\"noopener\">Part 1</a> and <a href=\"http://lowendbox.com/blog/centos-7-lamp-server-tutorial-modernized-and-explained-part-2/\" target=\"_blank\" rel=\"noopener\">Part 2</a> we configured a LAMP server with PHP-FPM running PHP 7.3 and a modern version of MariaDB. Then we configured a single VirtualHost for hosting a website, and in <a href=\"http://lowendbox.com/blog/centos-7-lamp-server-tutorial-part-3-lets-encrypt-ssl/\" target=\"_blank\" rel=\"noopener\">Part 3</a> configured that VirtualHost to run securely with a free Let\u2019s Encrypt SSL certificate.</p><p><span id=\"more-19970\"></span></p><p>In this bit, we\u2019re going to put our shiny new server to practical use by installing WordPress. We\u2019re also going to learn how to use a tool that\u2019ll allow us to install, configure, and maintain WordPress right from the command line.</p><h2>The WordPress Command Line Interface</h2><p>As its name clearly states, the WordPress Command Line Interface (or wp-cli) is a command line based administration for WordPress. Why would you want such a thing? Good question!</p><p>Linux server administrators are known for preferring to do things without having to leave the command line. Switching back and forth between a command line to a GUI or web interface is seen as inefficient at best. But there\u2019s more to it than just basic efficiencies. The command line interface can be automated with shell scripts that allow us to do otherwise tedious tasks without ever having to click a mouse button.</p><p>Furthermore, there are tasks that can be done via wp-cli that would otherwise require editing the WordPress database directly or by using third party plugins. Password resets, database search and replaces, and much much more are available. Let\u2019s get it installed!</p><h2>Installing wp-cli</h2><p>Before we install wp-cli, we need to satisfy one pre-requisite. In the first article in this LAMP tutorial series, we set up PHP 7.3 to work from the command line with</p><pre>scl enable php73 bash</pre><p>What we didn\u2019t do was set up the associations needed so that PHP 7.3 would work the same from the command line as via Apache. In its current state, PHP cannot access MySQL databases. Let\u2019s resolve that now. Paste in the following commands:</p><pre>echo #!/bin/bash &gt;&gt; /etc/profile.d/php73.sh\necho source /opt/remi/php73/enable &gt;&gt; /etc/profile.d/php73.sh\necho export X_SCLS=\"`scl enable php73 'echo $X_SCLS'`\" &gt;&gt; /etc/profile.d/php73.sh</pre><p>Now we\u2019re good to go. Installing wp-cli couldn\u2019t be simpler. Log in to your server as root and paste in the following commands:</p><pre>curl -O https://raw.githubusercontent.com/wp-cli/builds/gh-pages/phar/wp-cli.phar\nchmod +x wp-cli.phar\nmv wp-cli.phar /usr/local/bin/wp</pre><p>You can test your new wp-cli installation by simply typing the command \u201cwp\u201d at the command line:</p><p><img data-lazyloaded=\"1\" src=\"http://lowendbox.com/wp-content/uploads/2019/06/wpcli-test.png\" loading=\"lazy\" class=\"aligncenter wp-image-19977 size-full litespeed-loaded\" data-src=\"http://lowendbox.com/wp-content/uploads/2019/06/wpcli-test.png\" alt=\"\" width=\"646\" height=\"395\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2019/06/wpcli-test.png 646w, https://lowendbox.com/wp-content/uploads/2019/06/wpcli-test-300x183.png.webp 300w\" data-sizes=\"(max-width: 646px) 100vw, 646px\" sizes=\"(max-width: 646px) 100vw, 646px\" srcset=\"https://lowendbox.com/wp-content/uploads/2019/06/wpcli-test.png 646w, https://lowendbox.com/wp-content/uploads/2019/06/wpcli-test-300x183.png.webp 300w\" data-was-processed=\"true\"></p><p>The help documentation will be loaded inside of a Linux program called&nbsp;<em>less</em>&nbsp;so that you can scroll through it with the up and down arrows on your keyboard. Go ahead and take a look at the page and get a feel for the capabilities that wp-cli has. Press q to exit.</p><h2>Installing WordPress on our VirtualHost</h2><p>You\u2019ll recall that we created a VirtualHost called lowend-tutorial.tld with the username \u201clowend\u201d. We\u2019re now going to create a database that matches that username for no other reason that to associate the two in our heads. We\u2019re also going to create a MySQL user with a unique password so that the database can be accessed by a non-root user. This is an <em>extremely</em> important step. Your databases should never be accessed as root! You\u2019ll want to substitute your own information of course.</p><h3>Creating the Database and User</h3><p>To create the database, we\u2019re going to need to switch to the MySQL (MariaDB) interface by simply typing</p><pre>mysql -u root -p</pre><p>We\u2019re logging in as root here because only the root user can add databases and database users. Edit the following command to match your own username and chosen password, and paste it in:</p><pre>create database lowend;\nGRANT ALL PRIVILEGES ON lowend.* TO 'lowend'@'localhost' IDENTIFIED BY 'Your-DB-Password';\nflush all privileges;</pre><p>In these three commands we created the database, created a user, and gave that user full access to the \u201clowend\u201d database and all its tables. Then we flushed the privileges to enact the changes. This is how it looked on our VPS:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4NDAiIGhlaWdodD0iMzM2IiB2aWV3Qm94PSIwIDAgODQwIDMzNiI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"aligncenter size-full wp-image-19979\" data-src=\"http://lowendbox.com/wp-content/uploads/2019/06/wpssl-create-database-and-user.png\" alt=\"\" width=\"840\" height=\"336\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2019/06/wpssl-create-database-and-user.png 840w, https://lowendbox.com/wp-content/uploads/2019/06/wpssl-create-database-and-user-300x120.png.webp 300w, https://lowendbox.com/wp-content/uploads/2019/06/wpssl-create-database-and-user-768x307.png.webp 768w\" data-sizes=\"(max-width: 840px) 100vw, 840px\"></p><p>Make sure to keep track of the database name, username, and password. We\u2019ll need it to install WordPress. Exit the MySQL interface by simply typing \u201cexit\u201d and pressing Enter.</p><h1>Installing WordPress with wp-cli</h1><p>The typical method of installing WordPress involves downloading the files to the public_html directory and then going to the website in a browser to finish the installation. The wp-cli program lets us skip all of that and perform the installation all from the command line.</p><p>First, switch to your VirtualHosts user and then to its public_html directory.</p><pre>su - lowend\ncd ~/public_html/</pre><p>This is the same public_html folder that we used to verify that PHP was working in Part 2 with the \u201ctest.php\u201d file. If that file still exists, it would be good to remove it.</p><pre>rm test.php</pre><p>With the public_html directory now empty, we\u2019ll begin the WordPress installation. First we need to use wp-cli to download the core WordPress files:</p><pre>wp core download</pre><p>If you now type \u201cls\u201d you will see all of the core WordPress files. Now we need to configure WordPress. WordPress\u2019 main configuration file is wp-config.php, and it contains all of the information that WordPress needs to talk to the database, and more. You\u2019ll see that it doesn\u2019t exist yet. We\u2019re going to use wp-cli to create it and then change its permissions so that they are correct. Edit the following command to match your configuration, then paste it in:</p><pre>wp core config --dbhost=localhost --dbname=lowend --dbuser=lowend --dbpass=Your-DB-Password\nchmod 644 wp-config.php</pre><p>Now WordPress knows how to talk to its database, but that database is still empty. WordPress now needs an identity and its first administrator. We\u2019re going to configure those using wp-cli and set some permissions. Again, edit the following so that it matches your own configuration, and paste it in. Be sure to use your real email address and set a strong password! You can be sure that as soon as you get WordPress installed, there will be bots trying to log into it. It\u2019s also recommended that you do not use \u201cwordpress_admin\u201d as your username for the administrative user. Choose something unique.</p><pre>wp core install --url=https://lowend-tutorial.tld --title=\"LowEnd Tutorial Site\" \\\n--admin_name=wordpress_admin --admin_password=\u200bYour-DB-Password \\\n--admin_email=your-email-address@gmail.com\nchmod 755 wp-content/uploads</pre><p>Here is how this looked on our server:</p><p><a href=\"http://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install.png\" target=\"_blank\" rel=\"noopener\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MjQiIGhlaWdodD0iMTg3IiB2aWV3Qm94PSIwIDAgOTI0IDE4NyI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"aligncenter wp-image-19978\" data-src=\"http://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install.png\" alt=\"\" width=\"924\" height=\"187\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install.png 1067w, https://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install-300x61.png.webp 300w, https://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install-768x155.png.webp 768w, https://lowendbox.com/wp-content/uploads/2019/06/wp-cli-wp-install-1024x207.png.webp 1024w\" data-sizes=\"(max-width: 924px) 100vw, 924px\"></a></p><p>Now, we can test to see our new website is working by simply visiting it in a browser: https://lowend-tutorial.tld. Check it out and come back when you\u2019re done.</p><p>Does it work? Great! If not, check for any errors along the way, and examine them for any typos or errors.</p><p>It\u2019s time to get logged in by going to https://lowend-tutorial.tld/wp-admin. Log in using the username and password you created with <em>wp core install</em>. Once you\u2019re logged in, navigate to Settings &gt; Permalinks &gt; select Post name, and then Save Changes as shown below:</p><p><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI5MDEiIGhlaWdodD0iNTA4IiB2aWV3Qm94PSIwIDAgOTAxIDUwOCI+PHJlY3Qgd2lkdGg9IjEwMCUiIGhlaWdodD0iMTAwJSIgZmlsbD0iI2NmZDRkYiIvPjwvc3ZnPg==\" loading=\"lazy\" class=\"aligncenter size-full wp-image-19985\" data-src=\"http://lowendbox.com/wp-content/uploads/2019/06/wp-permalinks-change.png.webp\" alt=\"\" width=\"901\" height=\"508\" data-srcset=\"https://lowendbox.com/wp-content/uploads/2019/06/wp-permalinks-change.png.webp 901w, https://lowendbox.com/wp-content/uploads/2019/06/wp-permalinks-change-300x169.png.webp 300w, https://lowendbox.com/wp-content/uploads/2019/06/wp-permalinks-change-768x433.png.webp 768w\" data-sizes=\"(max-width: 901px) 100vw, 901px\"></p><p>&nbsp;</p><p>Changing the Permalinks structure (the way that WordPress maps a URL to a page or blog post) finishes things off by writing the .htaccess file that\u2019s needed for many other WordPress functions. Reconfiguring the permalinks can be done via wp-cli, but when we tested it, it didn\u2019t write the .htaccess file. Your WordPress installation is now ready to be turned into an awesome website. Well done!</p><h2>Wait, that\u2019s it?</h2><p>Yep, you did it! You built a LAMP server with PHP 7.3, secured it with an automatically renewing Let\u2019s Encrypt SSL certificate, and installed WordPress. Be assured that we aren\u2019t just stopping here, however.</p><h2>A few more things\u2026</h2><p>In this series, you installed one user, one VirtualHost, one SSL certificate, and one website. But, if you create a second user, a second VirtualHost, and a second PHP-FPM configuration file, you can host a second website on your server! And a third, and a fourth, and\u2026 as many as your server can handle! The process can even be automated with some simple shell scripts.</p><p>Next up we\u2019ll be doing fun things like configuring Redis and then switching over to Nginx instead of Apache. You\u2019re ready to continue<a href=\"https://lowendbox.com/blog/centos-7-lamp-server-tutorial-part-5-speeding-up-wordpress-with-redis/\" target=\"_blank\" rel=\"noopener\"> Part 5: Speeding up WordPress with Redis</a></p><p class=\"dpsp-share-text\"></p><div id=\"dpsp-content-bottom\" class=\"dpsp-content-wrapper dpsp-shape-rounded dpsp-column-auto dpsp-has-spacing dpsp-no-labels dpsp-show-on-mobile dpsp-button-style-1 dpsp-has-icon-background dpsp-has-button-background dpsp-show-total-share-count dpsp-show-total-share-count-after\"><ul class=\"dpsp-networks-btns-wrapper dpsp-networks-btns-content dpsp-has-button-icon-animation\"><li><a rel=\"nofollow\" href=\"https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Flowendbox.com%2Fblog%2Fcentos-7-lamp-server-wordpress-wp-cli%2F&amp;t=CentOS%207%20LAMP%20Server%20Tutorial%20Part%204%3A%20WordPress%20and%20wp-cli\" class=\"dpsp-network-btn dpsp-facebook dpsp-no-label dpsp-first\" title=\"Share on Facebook\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://twitter.com/intent/tweet?text=CentOS%207%20LAMP%20Server%20Tutorial%20Part%204%3A%20WordPress%20and%20wp-cli&amp;url=https%3A%2F%2Flowendbox.com%2Fblog%2Fcentos-7-lamp-server-wordpress-wp-cli%2F&amp;via=LowEndNetwork\" class=\"dpsp-network-btn dpsp-twitter dpsp-no-label\" title=\"Share on Twitter\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li><li><a rel=\"nofollow\" href=\"https://www.linkedin.com/shareArticle?url=https%3A%2F%2Flowendbox.com%2Fblog%2Fcentos-7-lamp-server-wordpress-wp-cli%2F&amp;title=CentOS%207%20LAMP%20Server%20Tutorial%20Part%204%3A%20WordPress%20and%20wp-cli&amp;mini=true\" class=\"dpsp-network-btn dpsp-linkedin dpsp-no-label dpsp-last\" title=\"Share on LinkedIn\"><span class=\"dpsp-network-icon\"></span><span class=\"dpsp-network-label-wrapper\"></span></a></li></ul><div class=\"dpsp-total-share-wrapper\"><span class=\"dpsp-icon-total-share\"></span><span class=\"dpsp-total-share-count\">13</span><span>shares</span></div></div><div class=\"relpost-thumb-wrapper\"><div class=\"relpost-thumb-container\"><h3>Related posts:</h3><div style=\"clear: both\"></div><div style=\"clear: both\"></div><div class=\"relpost-block-container\"><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/lowendprotection-homemade-raspberry-pi-security-cloud-camera-setup/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/07/rpi_security1-150x150.jpg) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">LowEndProtection: Homemade Raspberry Pi Security Cloud Camera Setup</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/nginx-vs-openlitespeed-vs-apache/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Nginx vs. OpenLiteSpeed vs. Apache\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2020/04/nginx-vs-openlitespeed-vs-apache-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Nginx vs. OpenLiteSpeed vs. Apache</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/top-ten-things-that-should-be-in-your-dot-files/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Top Ten Things That Should Be In Your Dot Files\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Top Ten Things That Should Be In Your Dot Files</div></div></a><a class=\"relpost-block-single\" href=\"https://lowendbox.com/blog/shields-up-protecting-your-wordpress-site-with-wordfence/\"><div style=\"width: 150px; height: 215px;\"><div class=\"relpost-block-single-image\" alt=\"Shields Up! Protecting Your WordPress Site with Wordfence\" style=\"background: transparent url(https://lowendbox.com/wp-content/uploads/2013/05/lowendtutorial-150x150.png) no-repeat scroll 0% 0%; width: 150px; height: 150px;\"></div><div class=\"relpost-block-single-text\" style=\"font-family: Arial;  font-size: 12px;  color: #333333;\">Shields Up! Protecting Your WordPress Site with Wordfence</div></div></a></div><div style=\"clear: both\"></div></div></div><div id=\"author-bio-box\" style=\"background: #f8f8f8; border-top: 2px solid #cccccc; border-bottom: 2px solid #cccccc; color: #333333\"><h3><a style=\"color: #555555;\" href=\"https://lowendbox.com/blog/author/ryan-flowers/\" title=\"All posts by Ryan Flowers\" rel=\"author\">Ryan Flowers</a></h3><div class=\"bio-gravatar\"><img data-lazyloaded=\"1\" src=\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI3MCIgaGVpZ2h0PSI3MCIgdmlld0JveD0iMCAwIDcwIDcwIj48cmVjdCB3aWR0aD0iMTAwJSIgaGVpZ2h0PSIxMDAlIiBmaWxsPSIjY2ZkNGRiIi8+PC9zdmc+\" alt=\"\" data-src=\"https://secure.gravatar.com/avatar/4a6ed635b6c3c112666487683cb7f8e8?s=70&amp;d=retro&amp;r=pg\" data-srcset=\"https://secure.gravatar.com/avatar/4a6ed635b6c3c112666487683cb7f8e8?s=140&amp;d=retro&amp;r=pg 2x\" class=\"avatar avatar-70 photo\" height=\"70\" width=\"70\" loading=\"lazy\"></div><p class=\"bio-description\"></p></div></div><div class=\"feedback\"></div></div>"}